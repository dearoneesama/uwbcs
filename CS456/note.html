<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Week 1&period; Jan 5</title>
        <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

/* From extension vscode.markdown-math */
@font-face{font-family:KaTeX_AMS;font-style:normal;font-weight:400;src:url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(fonts/KaTeX_AMS-Regular.woff) format("woff"),url(fonts/KaTeX_AMS-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:700;src:url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:italic;font-weight:400;src:url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:400;src:url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Script;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(fonts/KaTeX_Script-Regular.woff) format("woff"),url(fonts/KaTeX_Script-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size1;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size1-Regular.woff) format("woff"),url(fonts/KaTeX_Size1-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size2;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size2-Regular.woff) format("woff"),url(fonts/KaTeX_Size2-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size3;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size3-Regular.woff) format("woff"),url(fonts/KaTeX_Size3-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size4;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Typewriter;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype")}.katex{text-rendering:auto;font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0}.katex *{-ms-high-contrast-adjust:none!important;border-color:currentColor}.katex .katex-version:after{content:"0.13.24"}.katex .katex-mathml{clip:rect(1px,1px,1px,1px);border:0;height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.katex .katex-html>.newline{display:block}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-style:italic;font-weight:700}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{border-collapse:collapse;display:inline-table;table-layout:fixed}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;position:relative;vertical-align:bottom}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;font-size:1px;min-width:2px;vertical-align:bottom;width:2px}.katex .vbox{align-items:baseline;display:inline-flex;flex-direction:column}.katex .hbox{width:100%}.katex .hbox,.katex .thinbox{display:inline-flex;flex-direction:row}.katex .thinbox{max-width:0;width:0}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .mspace{display:inline-block}.katex .clap,.katex .llap,.katex .rlap{position:relative;width:0}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{border:0 solid;display:inline-block;position:relative}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline{border-bottom-style:dashed;display:inline-block;width:100%}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{position:relative}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;min-width:1px}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;display:block;height:inherit;position:absolute;width:100%}.katex svg path{stroke:none}.katex img{border-style:none;max-height:none;max-width:none;min-height:0;min-width:0}.katex .stretchy{display:block;overflow:hidden;position:relative;width:100%}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{overflow:hidden;position:relative;width:100%}.katex .halfarrow-left{left:0;overflow:hidden;position:absolute;width:50.2%}.katex .halfarrow-right{overflow:hidden;position:absolute;right:0;width:50.2%}.katex .brace-left{left:0;overflow:hidden;position:absolute;width:25.1%}.katex .brace-center{left:25%;overflow:hidden;position:absolute;width:50%}.katex .brace-right{overflow:hidden;position:absolute;right:0;width:25.1%}.katex .x-arrow-pad{padding:0 .5em}.katex .cd-arrow-pad{padding:0 .55556em 0 .27778em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox,.katex .fcolorbox{border:.04em solid;box-sizing:border-box}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex .angl{border-right:.049em solid;border-top:.049em solid;box-sizing:border-box;margin-right:.03889em}.katex .anglpad{padding:0 .03889em}.katex .eqn-num:before{content:"(" counter(katexEqnNo) ")";counter-increment:katexEqnNo}.katex .mml-eqn-num:before{content:"(" counter(mmlEqnNo) ")";counter-increment:mmlEqnNo}.katex .mtr-glue{width:50%}.katex .cd-vert-arrow{display:inline-block;position:relative}.katex .cd-label-left{display:inline-block;position:absolute;right:calc(50% + .3em);text-align:left}.katex .cd-label-right{display:inline-block;left:calc(50% + .3em);position:absolute;text-align:right}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}.katex-display.leqno>.katex>.katex-html>.tag{left:0;right:auto}.katex-display.fleqn>.katex{padding-left:2em;text-align:left}body{counter-reset:katexEqnNo mmlEqnNo}

/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.katex-error {
	color: var(--vscode-editorError-foreground);
}

</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
    </head>
    <body class="vscode-body vscode-light">
        <p>Instructor: Noura Limam</p>
<p>Time: MW 2:30PM - 3:50PM</p>
<p>.1A * 3 + .25MT + .35FE + .15PJ + .02Q * 5</p>
<ul>
<li><a href="#week-1-jan-5">Week 1. Jan 5</a></li>
<li><a href="#week-2-jan-10">Week 2. Jan 10</a></li>
<li><a href="#week-3-jan-17">Week 3. Jan 17</a></li>
<li><a href="#week-4-jan-24">Week 4. Jan 24</a></li>
<li><a href="#week-5-jan-31">Week 5. Jan 31</a></li>
<li><a href="#week-6-feb-7">Week 6. Feb 7</a></li>
<li><a href="#week-7-feb-14">Week 7. Feb 14</a></li>
<li><a href="#week-9-feb-28">Week 9. Feb 28</a></li>
<li><a href="#week-10-mar-7">Week 10. Mar 7</a></li>
<li><a href="#week-11-mar-14">Week 11. Mar 14</a></li>
<li><a href="#week-12-mar-21">Week 12. Mar 21</a></li>
<li><a href="#week-13-mar-28">Week 13. Mar 28</a></li>
<li><a href="#week-14-apr-4">Week 14. Apr 4</a></li>
</ul>
<h1 id="week-1-jan-5">Week 1. Jan 5</h1>
<h2 id="the-internet">the internet</h2>
<p>'nuts and bolts' view: connected computing devices</p>
<ul>
<li><em>hosts</em>: end systems</li>
<li>running network <em>apps</em> at edge</li>
<li><em>packet switches</em>: forward packets (chunks of data)
<ul>
<li>routers, switchers</li>
</ul>
</li>
<li><em>communication links</em>: fiber, radio, etc.
<ul>
<li>bandwidth is the transmission rate</li>
</ul>
</li>
<li><em>networks</em>: (sub-)collection of devices, routers and links managed by an organization</li>
<li><em><strong>internet</strong></em>: 'network of networks'</li>
</ul>
<p><img src="assets/w1_1.PNG" alt="img"></p>
<p>'service' view: infrastructure providing services to apps</p>
<ul>
<li>web, streaming media, social media, etc.</li>
<li>provides <em>programming interface</em> to distributed applications
<ul>
<li>'hooks' allowing sending/receiving apps to connect to, use internet transport service</li>
<li>provides service options (analogous to postal service)</li>
</ul>
</li>
</ul>
<p><strong>definition.</strong> <em>protocols</em> define the format, order of messages sent and received among network entities, and actins taken on message transmission and recept</p>
<ul>
<li>eg. HTTP, streaming video, skype, TCP, ethernet</li>
</ul>
<p><em>internet standards</em>: RFC, IETF</p>
<h3 id="closer-look-at-network-structure">closer look at network structure</h3>
<ul>
<li>network edge:
<ul>
<li>hosts: clients and servers</li>
<li>servers often in data centers</li>
</ul>
</li>
<li>access networks, physical media:
<ul>
<li>wired, wireless communication links</li>
</ul>
</li>
<li>network core:
<ul>
<li>interconnected routers</li>
<li>network of network</li>
</ul>
</li>
</ul>
<h3 id="host-sends-packets-of-data">host: sends packets of data</h3>
<ul>
<li>takes application message</li>
<li>breaks into smaller chunks (<em>packets</em>) of length L bits</li>
<li>transmits packet into access network at transmission rate R
<ul>
<li>aka link capacity or link bandwidth</li>
</ul>
</li>
<li><em>packet transmission delay</em> = L/R
<ul>
<li>this is before last bit even starts being transmitted through wire</li>
</ul>
</li>
</ul>
<h3 id="access-networks">access networks</h3>
<p>in <em>cable-based access</em>, <em>frequency division multiplexing (FDM)</em> is used to transmit different channels in different frequency bands over <strong>shared</strong> cable.</p>
<ul>
<li>homes share access network to cable headend</li>
<li><em>HFC</em>: hybrid fiber coax</li>
</ul>
<p>in <em>digital subscriber line (DSL)</em>, voice and data are transmitted at different frequencies over <strong>dedicated</strong> line to central office.</p>
<ul>
<li>use existing telephone line to central office DSLAM
<ul>
<li>data over DSL phone line goes to internet</li>
<li>voice over DSL phone goes to telephone net</li>
</ul>
</li>
</ul>
<p><em>home networks</em>:</p>
<pre><code><code><div>|                                                      |
| WiFi ---- router/firewall/NAT ---- cable/DSL modem --|-- to/from headend/central office
|(54,450Mbps)      |                                   |
|            wired ethernet (1Gbps)                    |
</div></code></code></pre>
<p>often access point, router and modem are combined in a single box.</p>
<p><em>wireless access networks</em>: shared wireless access network connects end system to router via base station aka 'access point'</p>
<ul>
<li>wireless local area networks (WLANs)</li>
<li>wide-area cellular access networks</li>
</ul>
<p><em>enterprise networks</em>:</p>
<ul>
<li>companies, universities, etc.</li>
<li>mixed of wired, wireless link technologies connecting mix of switches and routers</li>
</ul>
<p><em>data center networks</em>:</p>
<ul>
<li>high-bandwidth links (10s to 100s Gbps) connect hundreds to thousands of services together and to internet</li>
</ul>
<h3 id="links-physical-media">links: physical media</h3>
<ul>
<li><em>bit</em> propagates between transmitter/receiver pairs</li>
<li><em>physical link</em>: lies between transmitter and receiver</li>
<li><em>guided media</em>: signals propagate in solid media (copper, fiber, coax)</li>
<li><em>unguided media</em>: signals propagate freely (radio)</li>
</ul>
<p><em>twisted pair (TP)</em>: two insulated copper wires (wrapped around each other)</p>
<ul>
<li>ethernet: more speed -&gt; more pairs (wires)</li>
</ul>
<p><em>coaxial cable</em>: two concentric copper conductors</p>
<ul>
<li>bidirectional</li>
<li>broadband: multiple frequency channels on cable; 100's Mbps per channel</li>
</ul>
<p><em>fiber optic cable</em>: glass fiber carrying light pulses, each pulse a bit</p>
<ul>
<li>high-speed point-to-point transmission (10's-100's Gbps)</li>
<li>low error rate:
<ul>
<li>repeaters spaced far apart</li>
<li>immune to EM noice</li>
</ul>
</li>
</ul>
<p><em>wireless radio</em>: signal carried in various 'band' in EM spectrum</p>
<ul>
<li>no physical 'wire'</li>
<li>broadcast, 'half-duplex' (sender to receiver)</li>
<li>has environmental effects: reflection, obstruction, interference/noise</li>
<li>types:
<ol>
<li>wireless LAN: 10-100's Mbps; 10's of meters</li>
<li>wide-area: 10's Mbps over ~10 km</li>
<li>bluetooth: short distances, limited rates</li>
<li>terrestrial microwave: point-to-point; 45 Mbps channels</li>
<li>satellite: up to 45 Mbps per channel; 270 ms end-end latency</li>
</ol>
</li>
</ul>
<h3 id="network-core">network core</h3>
<ul>
<li>mesh of interconnected routers</li>
<li><em>packet-switching</em>: hosts break application-layer messages into packets
<ul>
<li>network forwards packets from one router to the next, across links on path from source to destination</li>
</ul>
</li>
</ul>
<p>key network-core functions:</p>
<ul>
<li>routing<span id="routing-forwarding"></span>:
<ul>
<li>global action</li>
<li>determine source-destination paths taken by packets</li>
<li>routing algorithms</li>
<li>going from San Jose to Northampton</li>
</ul>
</li>
<li><em>forwarding (switching)</em>:
<ul>
<li>local action</li>
<li>move arriving packets from router's input link to appropriate router output link</li>
<li>moving car in intersection</li>
</ul>
</li>
</ul>
<p>store-and-forward switching:</p>
<pre><code><code><div>me  ----- router ----- destination
</div></code></code></pre>
<ul>
<li>entire packet must arrive at router before it can be transmitted on next link</li>
<li>two packet transmission delays (L/R)</li>
</ul>
<p><strong>eg.</strong> assuming propagating in cable and processing take no time. 3 packets, L = 10 Kbits, R = 100 Mbps. then one-hop transmission delay = 0.1 ms. then total = 0.4 ms.</p>
<pre><code><code><div>|            |            |t=0
|////////////|            |.1
|++++++++++++|////////////|.2
|============|++++++++++++|.3
|            |============|.4
source      router        dest
</div></code></code></pre>
<p>if we had one more router, then the total delay would be 0.5 ms.</p>
<p><em>queueing packet switching</em>:</p>
<ul>
<li>router receives packets from multiple sources, but sends packets to one place</li>
<li><em>packet queuing and loss</em>: if arrival rate to link exceeds transmission rate of link of some period of time, packets will queue, waiting to be transmitted on output link
<ul>
<li>packets can be dropped (lost) if memory (buffer) in router fills up</li>
</ul>
</li>
</ul>
<h1 id="week-2-jan-10">Week 2. Jan 10</h1>
<p><em>circuit switching</em>:</p>
<ul>
<li>alternative to packet switching</li>
<li>links are divided into circuits (channels)</li>
<li>end-end resources (links) are allocated and reserved for 'call' between source and destination</li>
<li>no sharing =&gt; circuit-like (guaranteed) performance</li>
<li>circuit segment idle if not used by call</li>
<li>commonly used in traditional telephone networks</li>
<li>methods of dividing:
<ul>
<li>frequency division multiplexing (FDM): optical, EM frequencies divided into narrow frequency bands
<ul>
<li>each call allocated its own band, can transmit at max rate of that narrow band</li>
</ul>
</li>
<li>time division multiplexing (TDM): time divided into slots
<ul>
<li>each call allocated periodic slots, can transmit at max rate of frequency band during its time slot. if we have idle users, we waste transmit rate.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>eg.</strong> packet switching vs. circuit switching:</p>
<ul>
<li>there is 1Gb/s output link</li>
<li>there are 35 users, each uses 100 Mb/s when active. they are active 10% of time</li>
<li>if using circuit-switching, we can at max accommodate 10 users at same time</li>
<li>if using packet switching, probability &gt; 10 active at same time is less than 0.0004, so we can generally serve all users at same time
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>11</mn></mrow><mn>35</mn></msubsup><msubsup><mi>C</mi><mn>35</mn><mi>i</mi></msubsup><msup><mi>p</mi><mi>i</mi></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mrow><mn>35</mn><mo>−</mo><mi>i</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\sum_{i=11}^{35} C_{35}^{i}p^{i}(1-p)^{35-i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2537em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">11</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">35</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">35</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0747em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">35</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>packet switching is good for 'bursty' data -&gt; sometimes has data to send, but at other times not
<ul>
<li>resource sharing; simpler, no call setup</li>
</ul>
</li>
<li>packet switching has possible excessive congestion: packet delay and loss due to overflow
<ul>
<li>protocols needed for reliable data transfer and congestion control</li>
</ul>
</li>
<li>IETF DiffServ proposes standard to let packet switching behave similar to circuit switching</li>
</ul>
<h3 id="internet-structure">internet structure</h3>
<p>how to connect millions of access ISPs together?</p>
<p>we connect each access ISP to one global transit ISP network (interconnected ISPs)</p>
<ul>
<li>customer and provider ISPs have economic agreement</li>
<li>global ISPs may be connected using <em>internet exchange points (IXPs)</em> and <em>peering links (POP)</em></li>
<li>... and regional networks may arise to connect access nets to ISPs</li>
</ul>
<p><img src="assets/w2_1.PNG" alt="img"></p>
<ul>
<li>at 'center' (small number of well-connected large networks)
<ul>
<li>tier-1 commercial ISPs (AT&amp;T)</li>
<li>content provider networks (Google): private network that connects its data centers to internet, often bypassing tier-1 and regional ISPs</li>
</ul>
</li>
</ul>
<h3 id="performance">performance</h3>
<p>sources of packet delays:</p>
<ol>
<li>transmission delay: L/R</li>
<li>queueing delay <em>(traffic intensity)</em>
<ul>
<li>depends on congestion level</li>
<li>L*a/R = arrival rate of bits / service rate of bits, where
<ul>
<li>a: average packet arrival rate</li>
<li>L: packet length (bits)</li>
<li>link bandwidth (bit transmission rate)</li>
</ul>
</li>
<li>~0: avg queueing delay small</li>
<li>-&gt; 1: avg queueing delay large</li>
<li>&gt; 1: more work arriving is more than what can be processed - infinite average delay</li>
</ul>
</li>
<li><em>nodal processing delay</em>
<ul>
<li>check bit errors</li>
<li>determine output link</li>
<li>typically under 1 ms; we do not count</li>
</ul>
</li>
<li><em>propagation delay</em>
<ul>
<li>d/s, where
<ul>
<li>d = length of physical link</li>
<li>s = propagation speed</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><code>traceroute</code>: provides delay measurements along end-end internet path.</p>
<p>packet loss:</p>
<ul>
<li>packet arriving to full queue is dropped</li>
<li>lost packet may be retransmitted by previous node, by source end system, or not at all</li>
</ul>
<p><em>throughput</em>: rate (bits/time) at which bits are sent from sender to receiver</p>
<ul>
<li><em>instantaneous</em></li>
<li><em>average</em></li>
<li><em>bottleneck link</em>: link on end-end path that constrains throughput with lowest transmission rate</li>
</ul>
<p><strong>eg.</strong> what is end-end throughput per connection?</p>
<pre><code><code><div>S  S  ...  S  (10)
\  \       /
      |
      R
      |
/  /  ...  \
C  C       C  (10)
</div></code></code></pre>
<p>min(RS, RC, R/10).</p>
<h3 id="security">security</h3>
<p>internet was not originally designed to be much secure.</p>
<ul>
<li>original: 'a group of mutually trusting users attache to a transparent network'</li>
</ul>
<p>packet interception:</p>
<ul>
<li><em>packet sniffing</em>: promiscuous network interface reads all packets passing by in broadcast media (shared wireless)</li>
<li>wireshark</li>
</ul>
<p>fake identity:</p>
<ul>
<li><em>IP spoofing</em>: injection of packet with false source address</li>
</ul>
<p><em>denial of service (DoS)</em>: attackers make resources unavailable to legitimate traffic by overwhelming resources with bogus traffic</p>
<ol>
<li>select target</li>
<li>break into hosts around the network (botnet)</li>
<li>send packets to target from compromised hosts</li>
</ol>
<p>lines of defense:</p>
<ul>
<li><em>authentication</em>: providing you are who you say you are
<ul>
<li>cellular networks provide hardware identity via SIM card; no such hardware assist in traditional internet</li>
</ul>
</li>
<li><em>confidentiality</em>: via encryption</li>
<li><em>integrity checks</em>: digital signatures to prevent tampering</li>
<li><em>access restrictions</em>: VPNs</li>
<li><em>firewalls</em>: 'middleboxes' in access and core networks
<ul>
<li>off-by-default: filter incoming traffic to restrict senders, receivers, and apps</li>
<li>detect and react to DoS</li>
</ul>
</li>
</ul>
<h3 id="protocol-layers">protocol layers</h3>
<p>layering:</p>
<ul>
<li>explicit structure allows identification, relationship of system's pieces</li>
<li>modularization eases maintenance and updating</li>
</ul>
<p>layered <em>internet protocol stack</em>:</p>
<ol>
<li><em>application</em>: supporting applications
<ul>
<li>HTTP, IMTP</li>
</ul>
</li>
<li><em>transport</em>: process-process data transfer
<ul>
<li>TCP, UDP</li>
</ul>
</li>
<li><em>network</em>: routing of datagrams from source to destination
<ul>
<li>IP, routing protocols</li>
</ul>
</li>
<li><em>link</em>: data transfer between neighboring network elements
<ul>
<li>ethernet, WiFi, PPP</li>
</ul>
</li>
<li><em>physical</em></li>
</ol>
<p>how to pass a message:</p>
<ol>
<li>application exchanges <em>message</em> M to implement some app service using services of transport layer</li>
<li>transport layer protocol transfers M (eg reliably) from one process to another, using services of network layer
<ul>
<li>it encapsulates app-layer message M with transport layer header Ht to create a transport-layer <em>segment</em></li>
</ul>
</li>
<li>network layer protocol transfers transport-layer segment [Ht M] from one host to another using link layer services
<ul>
<li>it encapsulates transport-layer segment [Ht M] with network-layer header Hn to create a <em>datagram</em></li>
</ul>
</li>
<li>link layer protocol transfers datagram [Hn Ht M] from host to neighboring hosts using network layer services
<ul>
<li>it encapsulates network datagram [Hn Ht M] with link-layer header Hl to create a link-layer <em>frame</em></li>
</ul>
</li>
<li>we do not cover physical layer</li>
<li>decapsulate the datagram in reverse order on receipt</li>
</ol>
<p>switching devices do not implement all the layers:</p>
<p><img src="assets/w2_2.PNG" alt="img"></p>
<h1 id="week-3-jan-17">Week 3. Jan 17</h1>
<h2 id="application-layer">application layer</h2>
<p>web app:</p>
<ul>
<li>write program that run end systems and communicate over network</li>
<li>no need to write software for network-core devices. they do not run on user applications to allow rapid development</li>
</ul>
<p><em>client-server paradigm</em>:</p>
<ul>
<li>server:
<ul>
<li>always-on host</li>
<li>permanent IP</li>
<li>often in data centers, for scaling</li>
</ul>
</li>
<li>client:
<ul>
<li>contact, communicate with server</li>
<li>may be intermittently connected</li>
<li>may have dynamic IP</li>
<li>do not communicate with each other directly</li>
</ul>
</li>
<li>HTTP, IMAP, FTP</li>
</ul>
<p><em>peer-peer architecture</em>:
<span id="peer-peer-architecture"></span></p>
<ul>
<li>service is not provided by an always-on server</li>
<li>arbitrary end systems directly communicate</li>
<li>self scalability: new peers bring new service capacity as well as new service demands</li>
<li>peers are intermittently connected and change IP
<ul>
<li>complex management</li>
</ul>
</li>
<li>P2P</li>
</ul>
<p>processes communicating:</p>
<ul>
<li><em>process</em>: program running in a host
<ul>
<li><em>client process</em>: that initiates communication</li>
<li><em>server process</em> that waits to be connected</li>
</ul>
</li>
<li>within same host, two communicate using <em>IPC</em></li>
<li>processes in different hosts communicate by exchanging <em>messages</em></li>
<li>in P2P apps, client and server process run on same machine</li>
</ul>
<p><em>sockets</em>:</p>
<ul>
<li>process sends/receives messages to/from its <em>socket</em>(door)</li>
<li>two sockets involved: one on each side</li>
</ul>
<p><img src="assets/w3_1.PNG" alt="img"></p>
<p>process addressing:</p>
<ul>
<li>to receive messages, process must have identifier including
<ul>
<li>IP address (32bit)</li>
<li><em>port numbers</em> (16bit) associated with process</li>
</ul>
</li>
<li>HTTP: 80, mail: 25</li>
</ul>
<p>app-layer protocols:</p>
<ul>
<li>defines types of messages exchanged</li>
<li>message syntax</li>
<li>message semantics</li>
<li>rules for when and how processes send &amp; respond</li>
</ul>
<p>open protocols are defined in RFCs and allows interoperability by giving access of definition to everyone.</p>
<p>what app needs from transport service:</p>
<ul>
<li>reliability</li>
<li>timing</li>
<li>throughput</li>
<li>security
<ul>
<li>'elastic apps' make use of whatever throughput they get</li>
</ul>
</li>
<li><em><a href="#transport-control-protocol">TCP service</a></em> <span id="tcp-service"></span>
<ul>
<li>reliable transport between sender and receiver</li>
<li><em>flow control</em>: sender will not overwhelm receiver</li>
<li><em>congestion control</em>: throttle sender when network is overloaded</li>
<li><em>connection-oriented</em>: setup (handshake) required between client and server</li>
<li>does not provide timing, minimum throughput guarantee and security</li>
</ul>
</li>
<li><em><a href="#user-datagram-protocol">UDP service</a></em>
<ul>
<li>unreliable data transfer between sender and receiver</li>
<li>does not provide reliability, flow control, congestion control, timing, throughput guarantee, security, or connection setup</li>
<li>less overhead to network and faster</li>
<li>whatever missing from UDP can be implemented on app layer</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:right">app</th>
<th style="text-align:left">app layer protocol</th>
<th style="text-align:right">transport protocol</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">file transfer</td>
<td style="text-align:left">FTP</td>
<td style="text-align:right">TCP</td>
</tr>
<tr>
<td style="text-align:right">email</td>
<td style="text-align:left">SMTP</td>
<td style="text-align:right">TCP</td>
</tr>
<tr>
<td style="text-align:right">web docs</td>
<td style="text-align:left">HTTP</td>
<td style="text-align:right">TCP</td>
</tr>
<tr>
<td style="text-align:right">internet telephony</td>
<td style="text-align:left">SIP, RTP or proprietary</td>
<td style="text-align:right">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:right">streaming</td>
<td style="text-align:left">HTTP, DASH</td>
<td style="text-align:right">TCP</td>
</tr>
<tr>
<td style="text-align:right">interactive games</td>
<td style="text-align:left">WOW, FPS (proprietary)</td>
<td style="text-align:right">UDP/TCP</td>
</tr>
</tbody>
</table>
<p>security in TCP:</p>
<ul>
<li>vanilla TCP/UDP sockets has no encryption</li>
<li><em>transport layer security (TLS)</em>: on top of TCP
<ul>
<li>provides encrypted TCP connections</li>
<li>data integrity</li>
<li>end-point authentication</li>
<li>apps use TLS libraries</li>
</ul>
</li>
</ul>
<h3 id="http">HTTP</h3>
<ul>
<li>web pages consist of <em>objects</em> stored on different web servers</li>
<li>base HTML-file includes several referenced objects, each addressable by a URL (host name + /path name)</li>
</ul>
<p><em>hypertext transfer protocol (HTTP)</em>:</p>
<ul>
<li>web's app-layer protocol</li>
<li>client: browser requests, receives and displays content</li>
<li>server sends object in response</li>
<li>uses TCP
<ol>
<li>client initiates TCP to <code>server:80</code></li>
<li>server accepts TCP connection from client</li>
<li>HTTP messages exchanged between client and server</li>
<li>TCP connection closed</li>
</ol>
</li>
<li>stateless: server maintains no information about past client requests</li>
</ul>
<p><em>non-persistent HTTP</em> (HTTP1.0):</p>
<ul>
<li>TCP connection opened, at most one object sent, then closed</li>
<li>problems:
<ul>
<li>requires 2RTTs per object</li>
<li>OS overhead for each TCP connection</li>
<li>so browsers often open multiple connections in parallel</li>
</ul>
</li>
</ul>
<p>response time:</p>
<ul>
<li><em>round trip time (RTT)</em>: time for a small packet to travel from client to server and back</li>
<li>non-persistent HTTP response time = 2RTT + file transmission ime</li>
</ul>
<p><img src="assets/w3_2.PNG" alt="img"></p>
<p><em>persistent HTTP</em> (HTTP1.1):</p>
<ul>
<li>allows multiple objects to be sent over single TCP connection</li>
<li>as little as one RTT for all referenced objects</li>
<li>problems:
<ul>
<li>pipelined means server responds in-order (FCFS)</li>
<li>small objects may have to wait for transmission <em>(head-of-line (HOL) blocking)</em> behind large objects</li>
<li>loss recovery (retransmitting lost TCP segments) stalls object transmission</li>
</ul>
</li>
</ul>
<p>HTTP request message:</p>
<ul>
<li>ASCII (human-readable format)</li>
</ul>
<pre><code class="language-bash"><div>GET /index.html HTTP/1.1\r\n
Host: www.example.com\r\n
User-Agent: Mozilla/5.0\r\n     <span class="hljs-comment"># headers</span>
Accept: text/html\r\n
Connection: keep-alive\r\n
\r\n                            <span class="hljs-comment"># carriage return and line feed at line start indicates</span>
                                <span class="hljs-comment"># end of headers</span>
<span class="hljs-comment"># no body for GET request</span>
</div></code></pre>
<ul>
<li><em>POST</em>: user input in entity body sent from client</li>
<li><em>GET</em>: include user data in URL (<code>?abc&amp;def=ghi</code>)</li>
<li><em>HEAD</em>: like GET, but wants only header</li>
<li><em>PUT</em>: upload object to server and completely replaces if existing</li>
<li>...</li>
</ul>
<p>HTTP response message:</p>
<pre><code class="language-bash"><div>HTTP/1.1 200 OK\r\n
Date: Mon, 27 Jul 2009 12:28:53 GMT\r\n
Server: Apache/2.2.14 (Win32)\r\n
Last-Modified: Wed, 22 Jul 2009 19:15:56 GMT\r\n
Content-Length: 298\r\n
Content-Type: text/html\r\n
\r\n
<span class="hljs-comment"># body</span>
</div></code></pre>
<ul>
<li>200 OK</li>
<li>301 Moved Permanently</li>
<li>404 Not Found</li>
<li>...</li>
</ul>
<pre><code class="language-bash"><div>$ nc -c -v www.example.com 80
GET /index.html HTTP/1.1
Host: www.example.com

</div></code></pre>
<p>HTTP/2:</p>
<ul>
<li>key goal: decrease delay in multi-object HTTP requests</li>
<li>increased flexibility at server in sending objects to client
<ul>
<li>methods, status codes, most header fields unchanged from HTTP/1.1</li>
<li>transmission order of requested objects based on client-specified priority (not necessarily FCFS)</li>
<li>can push unrequested objects to client</li>
<li>divide objects into smaller <em>frames</em> which are scheduled to mitigate HOL blocking</li>
</ul>
</li>
<li>problems
<ul>
<li>recovery from packet loss still stalls object transmissions
<ul>
<li>as in HTTP/1.1, browsers incentive to open multiple parallel connections, increasing overall throughput</li>
</ul>
</li>
<li>not secure over vanilla TCP connection</li>
</ul>
</li>
</ul>
<p>HTTP/3:</p>
<ul>
<li>adds security, per object error- and congestion-control (more pipelining) over UDP</li>
</ul>
<h3 id="cookies">cookies</h3>
<p>websites and client browser use <em>cookies</em> to maintain state between transactions.</p>
<ul>
<li>used for: authorization, shopping cart, user session state</li>
</ul>
<p>four components:</p>
<ol>
<li>cookie header line of HTTP response message</li>
<li>cookie header line in next HTTP request message</li>
<li>cookie file kept on user's host, managed by user's browser</li>
<li>back-end database at website</li>
</ol>
<p><img src="assets/w3_3.PNG" alt="img"></p>
<p>how to keep state:</p>
<ul>
<li>at protocol endpoints: maintain state at sender/receiver over transactions</li>
<li>in messages: cookie in HTTP messages carry state</li>
</ul>
<p>privacy:</p>
<ul>
<li>cookies permit site to learn a lot about users</li>
<li>3rd party persistent cookies (tracking cookies) allow common identity to be tracked across multiple websites</li>
</ul>
<h3 id="web-caches">web caches</h3>
<p>goal satisfy client requests without involving origin server</p>
<ul>
<li>user configures browser to a (local) web cache (proxy servers)</li>
<li>browser sends all HTTP requests to cache; if not in cache, then request origin server</li>
<li>web cache acts as both client and server</li>
<li>server tells cache about object's allowable caching in response header (<code>Cache-Control: max-age=&lt;seconds&gt;/no-cache</code>)</li>
</ul>
<p>advantage:</p>
<ul>
<li>reduce response time for client request</li>
<li>reduce traffic on on institution's network</li>
<li>enable 'poor' content providers to more effectively deliver content</li>
</ul>
<p><strong>eg.</strong> RTT from pubic internet router to server is 2 seconds, average web object size is 100 K bits, there are 15 requests on average.</p>
<pre><code><code><div>   origin servers
         |
public internet router
--------------------------------
         |
         | 1.54 Mbps access link
--------------------------------
institutional network router
         | 1 Gbps LAN
      clients
</div></code></code></pre>
<ul>
<li>the average data rate from server to browsers is 100K * 15 = 1.5 Mbps</li>
<li>access link utilization is 1.5 Mbps / 1.54 Mbps = 0.97
<ul>
<li>=&gt; large queueing delays</li>
</ul>
</li>
<li>LAN utilization is 1.5 Mbps / 1 Gbps = 0.0015</li>
<li>end-to-lay delay = internet delay + access link delay + LAN delay = 2s + minutes + μsecs =&gt; slow (estimation)</li>
</ul>
<p>option 1: but faster access link</p>
<ul>
<li>access link rate is now 154 Mbps</li>
<li>access link util = 0.0097, LAN util = 0.0015</li>
<li>end-to-end lay = 2s + msecs + usecs ~ 2s</li>
</ul>
<p>option 2: install web cache in institutional network</p>
<ul>
<li>now requests route to cache first</li>
<li>suppose cache hit rate 0.4</li>
<li>40% requests served by cache with very low delay</li>
<li>60% requests served by origin
<ul>
<li>rate to browsers over access link = 0.6 * 1.5 Mbps = 0.9 Mbps</li>
<li>access link util = 0.9 Mbps / 1.54 Mbps = 0.58</li>
</ul>
</li>
<li>average end-end delay = 0.6(delay from origin servers) + 0.4(delay when satisfied by cahce) = 0.6*2.01s + 0.4*(~msecs) ~ 1.2s</li>
</ul>
<p><em>conditional GET</em>:</p>
<ul>
<li>goal: do not send objects if cache has up-to-date cached version
<ul>
<li>no object transmission delay</li>
</ul>
</li>
<li>client specified data of cached copy in request (<code>If-modified-since: &lt;date&gt;</code>)</li>
<li>server responds contains no object (304 Not Modified) if cached copy is up-to-date</li>
<li>a little bit of delay incurred by cache. however if object is not updated we still save some time.</li>
</ul>
<h1 id="week-4-jan-24">Week 4. Jan 24</h1>
<h3 id="email">email</h3>
<p>three major components:</p>
<ul>
<li><em>user agents</em> (mail reader)
<ul>
<li>composing, editing and reading mails</li>
<li>outgoing, incoming emails stored on server</li>
</ul>
</li>
<li>mail servers
<ul>
<li><em>mailbox</em> contains incoming messages</li>
<li><em>message queue</em> of outgoing mails</li>
</ul>
</li>
<li>simple mail transfer protocol: <em>SMTP</em>
<ul>
<li>between mail servers to send email messages</li>
<li>client: sending mail server</li>
<li>'server': receiving mail server</li>
</ul>
</li>
</ul>
<p>SMTP RFC:</p>
<ul>
<li>uses TCP to reliably transfer email messages to server with port 25
<ul>
<li>direct transfer: sending server (client) to receiving server</li>
</ul>
</li>
<li>after TCP connection, three phases of transfer:
<ol>
<li>SMTP handshake</li>
<li>SMTP transfer of message</li>
<li>SMTP close</li>
</ol>
</li>
<li>command/response interactions (like HTTP)
<ul>
<li>commands: ASCII text</li>
<li>responses: code and phrase</li>
</ul>
</li>
</ul>
<p><img src="assets/w4_3.PNG" alt="img"></p>
<p>sample interaction at step 3:</p>
<pre><code class="language-bash"><div>S: 220 example.com
C: HELO ecole.fr
S: 250 Hello ecole.fr, pleased to meet you
C: MAIL FROM: &lt;alice@ecole.fr&gt;
S: 250 alice@ecole.fr... Sender OK
C: RCPT TO: &lt;bob@example.com&gt;
S: 250 bob@example.com... Recipient OK
C: DATA  <span class="hljs-comment"># start the email</span>
S: 354 Enter mail, end with <span class="hljs-string">&quot;.&quot;</span> on a line by itself
C: FROM: alice@ecole.fr
C: TO: bob@example.com
C: SUBJECT: Hello!
C:
C: Do you like Math?
C: How about Science?
C: .
S: 250 Message accepted <span class="hljs-keyword">for</span> delivery
C: QUIT
S: 221 example.com closing connection
</div></code></pre>
<p>comparison with HTTP:</p>
<ul>
<li>HTTP
<ul>
<li>client pull</li>
<li>each object encapsulated in its own response message</li>
</ul>
</li>
<li>SMTP
<ul>
<li>client push</li>
<li>multiple objects sent in multipart message</li>
<li>uses persistent connections</li>
<li>requires message to be in 7-bit ASCII</li>
<li>uses <code>CRLF.CRLF</code> to determine end of message</li>
</ul>
</li>
<li>both have ASCII command/response interactions</li>
</ul>
<p>RFC 2822 define syntax for email message itself (different from commands above).</p>
<p>retrieving email uses different protocol than SMTP:</p>
<ul>
<li>IMAP: provides retrieval, deletion, folders on server</li>
<li>HTTP: gmail provides web-based interface on top of SMTP (to send). IMAP (or POP) to retrieve</li>
</ul>
<details>
<summary>Show demo code</summary>
<pre><code class="language-bash"><div>$ nc -C -v mxer.uwaterloo.ca 25
Connection to mxer.uwaterloo.ca 25 port [tcp/smtp] succeeded!
220 mxer.uwaterloo.ca ESMTP Sendmail 8.14.7/8.14.7 ready on mailchk-m02 at Mon, 24 Jan 2022 15:47:06 -0500 - problems to postmaster@uwaterloo.ca
HELO uwaterloo.ca
250 mailchk-m02.uwaterloo.ca Hello ubuntu.student.cs.uwaterloo.ca [127.0.0.1], pleased to meet you
MAIL FROM: ksnfanfnn@uwaterloo.ca
250 2.1.0 ksnfanfnn@uwaterloo.ca... Sender ok
RCPT TO: y3285wan@uwaterloo.ca
250 2.1.5 y3285wan@uwaterloo.ca... Recipient ok
DATA
354 Enter mail, end with <span class="hljs-string">&quot;.&quot;</span> on a line by itself
FROM: ksnfanfnn@uwaterloo.ca
TO: y3285wan@uwaterloo.ca
SUBJECT: Testing SMTP

Hello myself.
.
250 2.0.0 20OKl6BZ012876 Message accepted <span class="hljs-keyword">for</span> delivery
QUIT
221 2.0.0 mailchk-m02.uwaterloo.ca closing connection
<span class="hljs-built_in">exit</span>
</div></code></pre>
</details>
<h3 id="domain-name-system-dns">domain name system (DNS)</h3>
<p>how to map between IP address and name, and vice versa?</p>
<ul>
<li>this core internet function is implemented as app-layer protocol</li>
<li>DNS is distributed database implemented in hierarchy of many <em>name servers</em>
<ul>
<li>hosts, DNS servers communicate to resolve names</li>
<li>philosophy of internet: simple core, complexity at edges</li>
</ul>
</li>
<li>port 53</li>
</ul>
<p>DNS services do:</p>
<ul>
<li>hostname-IP translation</li>
<li>host aliasing: canonical, alias names</li>
<li>mail server aliasing</li>
<li>load distribution:
<ul>
<li>web servers are replicated: many IP maps to one name</li>
</ul>
</li>
<li>requirements:
<ul>
<li>homogenous distributed database: billion records, each simple</li>
<li>handles many trillions of queries a day
<ul>
<li>many more reads than writes</li>
<li>performance: almost every internet transaction interacts with DNS - ms count</li>
</ul>
</li>
<li>organizationally, physically decentralized
<ul>
<li>millions of orgs responsible for their records</li>
</ul>
</li>
<li>bulletproof: reliability, security</li>
</ul>
</li>
</ul>
<p>reasons to decentralize:</p>
<ul>
<li>avoid single point of failure</li>
<li>traffic volume</li>
<li>avoid distant centralized database</li>
<li>better maintenance</li>
</ul>
<p><img src="assets/w4_4.PNG" alt="img"></p>
<p>to find IP for <code>www.amazon.com</code>, client first queries root for <code>.com</code> DNS server, which queries <code>amazon.com</code> DNS server, finally resolve full name.</p>
<p><em>root name servers</em>:</p>
<ul>
<li>official, contact-of-last-resort by name servers that cannot resolve name</li>
<li>critically important internet function
<ul>
<li>DNSSEC - provides security</li>
</ul>
</li>
<li>ICANN manages a few root DNS domain</li>
<li>there are 13 logical root name 'servers' worldwide; each 'server' is replicated many times</li>
</ul>
<p><em>top-level domain (TLD)</em>:</p>
<ul>
<li>responsible for .com, .net, .cn, etc.</li>
<li>network solutions: authoritative registry for .com, .net TLD</li>
<li>educause: .edu TLD</li>
</ul>
<p><em>authoritative DNS servers</em>:</p>
<ul>
<li>org's own DNS servers providing authoritative hostname to IP mappings for org's named hosts</li>
<li>can be provided by org or service provider</li>
</ul>
<p>local DNS name servers:</p>
<ul>
<li>when host makes DNS query, it is sent to local DNS server first</li>
<li>local DNS server returns reply, answering
<ul>
<li>from its local cache of recent name-to-addr translations (can outdate)</li>
<li>forwarding request into DNS hierarchy resolution</li>
</ul>
</li>
<li>local DNS server does not strictly belong to hierarchy</li>
<li>each ISP has local DNS nama server
<ul>
<li><code>ipconfig /all</code></li>
</ul>
</li>
</ul>
<p>DNS resolution:</p>
<ul>
<li>iterated query: contacted server replies with name of server to contact</li>
<li>recursive query: puts burden of name resolution on contacted name server
<ul>
<li>heavy load at upper levels of hierarchy without cache</li>
</ul>
</li>
</ul>
<p><img src="assets/w4_5.PNG" alt="img"></p>
<p>caching DNS info:</p>
<ul>
<li>once (any) name server learns mapping, it caches mapping and immediately returns a cached mapping to respond query
<ul>
<li>improves response time</li>
<li>cache entries timeout after TTL</li>
<li>TLD servers typically cached in local name servers</li>
</ul>
</li>
<li>cached entries may be out of date
<ul>
<li>this is best effort</li>
</ul>
</li>
</ul>
<p>DNS records:</p>
<ul>
<li><em>RR</em> format: <code>(name, value, type, TTL)</code></li>
<li>type=A:
<ul>
<li>name=hostname, value=IP</li>
</ul>
</li>
<li>type=NS:
<ul>
<li>name=domain, value=hostname of authoritative name server for this domain</li>
</ul>
</li>
<li>type=CNAME:
<ul>
<li>name=alias name for some canonical name, value=canonical name</li>
</ul>
</li>
<li>type=NX:
<ul>
<li>value=name of SMTP mail server associated with name</li>
</ul>
</li>
</ul>
<p>DNS runs on both TCP and UDP, by default UDP, where query and reply have same format.</p>
<ul>
<li>for big UDP packet, server may drop. the client will retry with TCP.</li>
</ul>
<pre><code><code><div>&lt;      2bytes       &gt;&lt;       2bytes       &gt;
identification          flags                        (id: 16 bit for query, reply uses same number)
                                                     (flags: query/reply, recursion desired, recursion avai, reply is authorative)
# questions             # answer RRs
# authority RRs         # additional RRs
            questions                                (name, type fields)
            answers                                  (RRs in response)
            authority                                (records for authoritative servers)
            additional info
</div></code></code></pre>
<p>how to get info into the DNS:</p>
<ol>
<li>register name <code>example.com</code> at DNS registrar
<ul>
<li>provide names, IP of authoritative name server (primary and secondary)</li>
<li>registrar inserts NS, A RRs into .com TLD server:
<ul>
<li><code>(example.com, dns1.example.com, ns)</code></li>
<li><code>(dns1.example.com, 1.2.3.4, A)</code></li>
</ul>
</li>
</ul>
</li>
<li>create authoritative server locally with IP <code>1.2.3.4</code>
<ul>
<li>A record for <code>www.example.com</code></li>
<li>MX record for <code>example.com</code></li>
</ul>
</li>
</ol>
<p>DNS security:</p>
<ul>
<li>DDoS attacks
<ul>
<li>bombard root servers with traffic
<ul>
<li>not successful to date</li>
<li>root servers have traffic filtering and other bulletproofing</li>
<li>local DNS servers cache IPs of TLD servers, bypassing root server</li>
</ul>
</li>
<li>bombard TLD servers
<ul>
<li>potentially more dangerous</li>
</ul>
</li>
</ul>
</li>
<li>spoofing attacks:
<ul>
<li>intercept DNS queries and return bogus replies
<ul>
<li>DNS cache poisoning</li>
<li>RFC 4033</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="language-bash"><div>$ dig www.uwaterloo.com A

$ dig @a.root-servers.net www.uwaterloo.com A
$ dig @any.ca-servers.ca www.uwaterloo.com A
$ dig @ext-dns-aws.uwaterloo.ca www.uwaterloo.com A
</div></code></pre>
<h3 id="socket-programming">socket programming</h3>
<p>two socket types:</p>
<ul>
<li>UDP: unreliable datagram (group of bytes)</li>
<li>TCP: reliable, byte stream-oriented</li>
</ul>
<p>application example:</p>
<ol>
<li>client reads line of characters from keyboards then sends data to server</li>
<li>server receivers data and converts data to uppercase</li>
<li>servers sends</li>
<li>client receives and displays line</li>
</ol>
<p>with UDP:</p>
<ul>
<li>no handshaking before sending</li>
<li>sender explicitly attaches IP destination and port to each packets</li>
<li>receiver extracts sender IP address and port from received packet</li>
<li>transmitted data may be lost or received out-of order</li>
<li>app view: unreliable transfer of groups of bytes between server and client</li>
</ul>
<p><img src="assets/w4_1.PNG" alt="img"></p>
<pre><code class="language-py"><div><span class="hljs-keyword">from</span> socket <span class="hljs-keyword">import</span> *

<span class="hljs-comment"># server</span>
serverPort = <span class="hljs-number">12000</span>
serverSocket = socket(AF_INET, SOCK_DGRAM)
serverSocket.bind((<span class="hljs-string">&#x27;&#x27;</span>, serverPort))
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;The server is ready to receive&#x27;</span>)
<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    message, clientAddress = serverSocket.recvfrom(<span class="hljs-number">2048</span>)
    modifiedMessage = message.decode().upper()
    serverSocket.sendto(modifledMessage.encode(), clientAddress)

<span class="hljs-comment"># client</span>
serverName = <span class="hljs-string">&#x27;hostname&#x27;</span>
serverPort = <span class="hljs-number">12000</span>
clientSocket = socket(AF_INET, SOCK_DGRAM)
message = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Input lowercase sentence: &#x27;</span>)
clientSocket.seendto(message.encode(), (serverName, serverPort))
modifiedMessage, serverAddress = clientSocket.recvfrom(<span class="hljs-number">2048</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;From server: &#x27;</span>, modifiedMessage.decode())
clientSocket.close()
</div></code></pre>
<p>with TCP:</p>
<ul>
<li>client must contact server
<ul>
<li>server process must be first running</li>
<li>server must have created socket that welcomes client's contact</li>
</ul>
</li>
<li>client contacts server by:
<ul>
<li>creating TCP socket specifying IP:port</li>
<li>when client creates socket, client TCP establishes connection to server TCP</li>
</ul>
</li>
<li>when contacted by client, server TCP creates new socket for server for server process to communicate with that particular client
<ul>
<li>allowing server to talk with multiple clients</li>
<li>source port used to distinguish clients</li>
</ul>
</li>
<li>app viewpoint: reliable, in-order pipe between client and server</li>
</ul>
<p><img src="assets/w4_2.PNG" alt="img"></p>
<pre><code class="language-py"><div><span class="hljs-keyword">from</span> socket <span class="hljs-keyword">import</span> *

<span class="hljs-comment"># server</span>
serverPort = <span class="hljs-number">12000</span>
serverSocket = socket(AF_INET, SOCK_STREAM)
serverSocket.bind((<span class="hljs-string">&#x27;&#x27;</span>, serverPort))
serverSocket.listen(<span class="hljs-number">1</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;The server is ready to receive&#x27;</span>)
<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    connectionsSocket, address = serverSocket.accept()  <span class="hljs-comment"># new sock created on return</span>
    sentence = connectionsSocket.recv(<span class="hljs-number">1024</span>).decode()
    capitalizedSentence = sentence.upper()
    connectionsSocket.send(capitalizedSentence.encode())
    connectionsSocket.close()

<span class="hljs-comment"># client</span>
serverName = <span class="hljs-string">&#x27;hostname&#x27;</span>
serverPort = <span class="hljs-number">12000</span>
clientSocket = socket(AF_INET, SOCK_STREAM)
clientSocket.connect((serverName, serverPort))
message = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Input lowercase sentence: &#x27;</span>)
clientSocket.send(message.encode())
modifiedMessage = clientSocket.recv(<span class="hljs-number">1024</span>) <span class="hljs-comment"># no need to attach name:port</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;From server: &#x27;</span>, modifiedMessage.decode())
clientSocket.close()
</div></code></pre>
<h1 id="week-5-jan-31">Week 5. Jan 31</h1>
<h3 id="p2p">P2P</h3>
<p><a href="#peer-peer-architecture">desc</a></p>
<p>KPI: how much time to distribute file of size F from one server to N peers?</p>
<p><img src="assets/w5_1.PNG" alt="img"></p>
<p>client-server:</p>
<ul>
<li>server transmission: must sequentially send N file copies
<ul>
<li>time to send one: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">F/u_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>time to send N: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">NF/u_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NF</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>client: each client must download one copy
<ul>
<li>min client download time: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mtext>min</mtext></msub></mrow><annotation encoding="application/x-tex">F/d_{\text{min}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">min</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mtext>min</mtext></msub></mrow><annotation encoding="application/x-tex">d_{\text{min}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">min</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is min client download rate</li>
</ul>
</li>
<li>total: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>≥</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>N</mi><mi>F</mi></mrow><msub><mi>u</mi><mi>s</mi></msub></mfrac><mo separator="true">,</mo><mfrac><mi>F</mi><msub><mi>d</mi><mtext>min</mtext></msub></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D\geq\max(\frac{NF}{u_s},\frac{F}{d_{\text{min}}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3174em;vertical-align:-0.4451em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">NF</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.334em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">min</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>
<ul>
<li>at least increase linearly with N</li>
</ul>
</li>
</ul>
<p>using P2P:</p>
<ul>
<li>server transmission: must upload at least one copy
<ul>
<li>time to send one: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">F/u_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>client: each client must download one copt
<ul>
<li>min client download time: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mtext>min</mtext></msub></mrow><annotation encoding="application/x-tex">F/d_{\text{min}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">min</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>clients: as an aggregate must download NF bits
<ul>
<li>max upload rate (limiting max download rate) is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>s</mi></msub><mo>+</mo><mo>∑</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_s+\sum u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>total: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>≥</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mfrac><mi>F</mi><msub><mi>u</mi><mi>s</mi></msub></mfrac><mo separator="true">,</mo><mfrac><mi>F</mi><msub><mi>d</mi><mtext>min</mtext></msub></mfrac><mo separator="true">,</mo><mfrac><mrow><mi>N</mi><mi>F</mi></mrow><mrow><msub><mi>u</mi><mi>s</mi></msub><mo>+</mo><mo>∑</mo><msub><mi>u</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">D\geq\max\{\frac{F}{u_s},\frac{F}{d_\text{min}},\frac{NF}{u_s+\sum u_i}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3923em;vertical-align:-0.52em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.334em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord text mtight"><span class="mord mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">NF</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">}</span></span></span></span>
<ul>
<li>numerator increases linearly in N... but <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> also increases, so not necessarily linear, but log</li>
</ul>
</li>
</ul>
<p>BitTorrent:</p>
<ul>
<li>file divided into 256KB chunks which peers in swarm send and receive</li>
<li><em>tracker</em>: tracks peers participating in swarm</li>
<li><em>swarm</em>: group of peers exchanging chunks</li>
<li>steps:
<ol>
<li>downloads torrent</li>
<li>peer joining swarm
<ol>
<li>has no chunks, but will accumulate them over time from other peers</li>
<li>registers with track to get list of peers and connects to subset of peers (neighbors)</li>
</ol>
</li>
<li>while downloading, peer uploads chunks to other peers</li>
<li>chunks downloaded are hashed to verify integrity</li>
<li>peer may change peers with whom it exchanges chunks</li>
<li><em>churn</em>: peers may come and go</li>
<li>once peer has entire file, it may (selfishly) leave or remain (altruistically) in torrent (seeders)</li>
</ol>
</li>
<li>requesting chunks:
<ul>
<li>different peers have different subsets of chunks</li>
<li>periodically user asks each peer for list of chunks they have, and request missing chunks, rarest first</li>
<li>request broadcasted</li>
</ul>
</li>
<li>sending chunks: tit-for-tat
<ul>
<li>sends chunks to those four peers currently sending her chunks at highest rate
<ul>
<li>other peers are choked</li>
<li>re-evaluate top 4 every 10s</li>
<li>this prevents leaching</li>
</ul>
</li>
<li>every 30s, randomly select another peer and starts sending chunks
<ul>
<li>'optimistically unchoke' this peer</li>
</ul>
</li>
</ul>
</li>
<li>BitTorrent is tracker-less (decentralized index)
<ul>
<li>there can be a superpeer</li>
</ul>
</li>
</ul>
<h3 id="video-streaming">video streaming</h3>
<p>stream video traffic is major consumer of internet bandwidth.</p>
<p>challenges:</p>
<ul>
<li>scale - how to reach ~1B users</li>
<li>heterogeneity - different users have different capabilities</li>
<li>solution: distributed, application-level infrastructure</li>
</ul>
<p>simple scenario: streaming stored video</p>
<ul>
<li>server sends video file to client</li>
<li>main challenges:
<ul>
<li>server-to-client bandwidth varies over time with congestion levels</li>
<li>packet loss: delay playout, result in poor quality</li>
</ul>
</li>
</ul>
<p><em>dynamic, adaptive streaming over HTTP (DASH)</em>:</p>
<ul>
<li>server: divides video file into chunks
<ul>
<li>each chunk encoded at multiple rates</li>
<li>different rate encodings stored in different files</li>
<li>files replicated in various CND nodes</li>
<li><em>manifest files</em>: provides URLs for different chunks</li>
</ul>
</li>
<li>client: periodically estimates server-to-client bandwidth
<ul>
<li>consult manifest and requests one chunk at a time
<ul>
<li>when to request chunk: so that buffer starvation/overflow do not occur</li>
<li>what rate: higher quality when more bandwidth available</li>
<li>where to request chunk: close to client or high bandwidth</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>streaming video = encoding + DASH + playout buffering</p>
<h3 id="content-distribution-networks-cdn">content distribution networks (CDN)</h3>
<p>challenge: how to stream content to hundreds of thousands of simultaneous users?</p>
<ul>
<li>option 1: single mega-server
<ul>
<li>single point of failure, point of congestion, long path to distant clients</li>
</ul>
</li>
<li>option 2: store and server multiple copies of videos at multiple geographically distributed sites
<ul>
<li>enter deep: push CDN servers deep into many access networks</li>
<li>bring home: smaller number (10's) of larger clusters in POPs near access nets</li>
</ul>
</li>
</ul>
<p>steps:</p>
<ul>
<li>CND: stores copies of content at CDN nodes</li>
<li>subscriber requests content, service provider returns manifeset
<ul>
<li>using manifest, retrieves content at highest supportable rate</li>
<li>or different non-congested paths</li>
</ul>
</li>
</ul>
<p>CDNs are example of OTT (over the top): internet host-host communication as a service.</p>
<p>OTT challenges:</p>
<ul>
<li>coping with a congested internet from the edge</li>
<li>what content to place in which CDN node</li>
<li>from which CDN node to retrieve content at what rate</li>
</ul>
<h2 id="transport-layer">transport layer</h2>
<ul>
<li>provide logical communication between processes running on different processes</li>
<li>action network in end:
<ul>
<li>sender: breaks app messages into segments and pass to network layer</li>
<li>receiver: reassembles segments, pass to app layer</li>
</ul>
</li>
<li>network layer: logical communication between hosts</li>
<li>two services: <a href="#tcp-service">TCP, UDP</a></li>
<li>no delay or bandwidth guarantees</li>
</ul>
<p><em>multiplexing</em>:</p>
<ul>
<li>sender: handle data from multiple sockets, add transport headers</li>
<li>receiver: use header info to deliver received segments to correct socket
<ol>
<li>host receives ip datagrams, each has source IP:port, dest IP:port; one transport-layer segment</li>
<li>hose uses IP:port to direct segments to appropriate socket</li>
</ol>
</li>
</ul>
<pre><code><code><div>          32 bits
src port     |     dest port
-------------+----------------
        other headers
------------------------------
        payload
</div></code></code></pre>
<p>connectionless demultiplexing in UDP:</p>
<ul>
<li>before sending datagrams, must specify IP:port</li>
<li>receiving host checks port and directs segment to socket with that port</li>
<li>demux: receiver uses dest port only</li>
<li>if IP/UDP datagrams have dest same IP:port, but different source IP:port, they will be routed to same socket</li>
</ul>
<p>connection-oriented demultiplexing in TCP:</p>
<ul>
<li>TCP socket is identified by 4-tuple: source IP:port, dest IP:port</li>
<li>demux: receiver uses all 4 values to direct segment to socket</li>
<li>server may support many simultaneous TCP sockets
<ul>
<li>each is identified by entire 4 tuple, each associated with a client</li>
</ul>
</li>
</ul>
<p>multiplexing happen at all layers.</p>
<h3 id="user-datagram-protocol-udp">user datagram protocol (UDP)</h3>
<p><span id="user-datagram-protocol"></span></p>
<ul>
<li>no frills, bare bones internet transport protocol.</li>
<li>best effort: segments may be lost, out of order</li>
<li>connectionless: no handshaking, each segment handled independently of others</li>
<li>uses: streaming media, DNS, SNMP, HTTP/3</li>
</ul>
<p>advantages:</p>
<ul>
<li>no connection establishment delay</li>
<li>simple: no states</li>
<li>small header size</li>
<li>no congestion control: can function in the face of congestion</li>
<li>if reliable (HTTP/3), congestion control needed, add at app layer</li>
</ul>
<p>UDP segment header:</p>
<pre><code><code><div>       32 bits
---------+----------
src port | dest port
---------+----------
length   | checksum    # length including header
---------+----------
      payload
</div></code></code></pre>
<p>UDP checksum:</p>
<ul>
<li>goal: detect errors in segment</li>
<li>sender:
<ul>
<li>treat contents of UDP segment (including UDP headers &amp; IP) as sequence of 16-bit ints</li>
<li>add one's complement sum of segment content as <em>checksum</em></li>
</ul>
</li>
<li>receiver:
<ul>
<li>computes checksum of received segment</li>
<li>not equal: error detected; drop</li>
<li>equal: not necessarily mean errorless in connection...</li>
</ul>
</li>
</ul>
<p><strong>eg.</strong></p>
<pre><code><code><div>  1 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0
  1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
---------------------------------
1 1 0 1 1 1 0 1 1 1 0 1 1 1 0 1 1
---------------------------------
  1 0 1 1 1 0 1 1 1 0 1 1 1 1 0 0 wrap around (carryout added)
---------------------------------
  0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 1 checksum
</div></code></code></pre>
<h1 id="week-6-feb-7">Week 6. Feb 7</h1>
<p>f f 304 dns none http/tcp/dns/udp in/the/cache does/not/mean/anything mailserver cache/discard 12997158232 server/to/server copies 4321</p>
<h3 id="principles-of-reliable-data-transfer">principles of reliable data transfer</h3>
<ul>
<li>complexity of reliable data transfer protocol depend on characteristics of unreliable channel</li>
<li>sender and receiver do not know state of each other (eg was the message received?)</li>
</ul>
<p><img src="assets/w6_1.PNG" alt="img"></p>
<p>implementation: rdt1.0: reliable transfer over a reliable channel:</p>
<ul>
<li>assume underlying channel perfectly reliable</li>
<li>separate FSMs for sender and receiver, which sends/reads data from underlying channel</li>
</ul>
<p><img src="assets/w6_2.PNG" alt="img"></p>
<p>refinement: rdt2.0: channel with bit errors:</p>
<ul>
<li>underlaying channel may flip bits
<ul>
<li>we can check bit errors using checksum</li>
</ul>
</li>
<li>how to recover from errors?</li>
<li>receiver sends feedback
<ul>
<li><em>acknowledgement (ACK)</em>: receiver sends ack to sender</li>
<li><em>negative acknowledgement (NACK)</em>: receivers explicitly tells sender that packet has errors</li>
<li>sender retransmits packet on receipt on NAK</li>
</ul>
</li>
</ul>
<p>rdt2.0 with no errors:</p>
<p><img src="assets/w6_3.PNG" alt="img"></p>
<p>problem: what if ACK/NACK is corrupted?</p>
<ul>
<li>cannot just retransmit: possible duplicate NACKs sent by receiver</li>
<li>sender adds sequence number to each pkt</li>
<li>receiver discards if duplicate packet</li>
</ul>
<p>refinement: rdt2.1:</p>
<p><img src="assets/w6_4.PNG" alt="img"></p>
<p>refinement: rdt2.2: NAK-free protocol</p>
<ul>
<li>same functionality as rdt2.1 but using ACKs only</li>
<li>instead of NAK, receiver sends ACK for last packet received correctly</li>
<li>duplicate ACK at sender means error: sender retransmits</li>
</ul>
<p>refinement: rdt3.0: channel may lose packets</p>
<ul>
<li>sender waits for reasonable amount of time and retransmits</li>
<li>if packet is just delayed not lost, duplicate packet is ok because seq number handles this</li>
<li>countdown timer may be related to roundtrip time</li>
</ul>
<p>rdt3.0 sender:</p>
<p><img src="assets/w6_5.PNG" alt="img"></p>
<p>procedures:</p>
<p><img src="assets/w6_6.PNG" alt="img"></p>
<p>performance of rdt3.0:</p>
<ul>
<li>sender has to wait for a time before sending the next packet</li>
<li><em>utilization</em> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mtext>sender</mtext></msub></mrow><annotation encoding="application/x-tex">U_\text{sender}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">sender</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: fraction of time sender busy sending</li>
</ul>
<p><strong>eg.</strong> 1 Gbps link, 15 ms propagation delay, 8000 bit per packet. then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mtext>sender</mtext></msub><mo>=</mo><mfrac><mrow><mi>L</mi><mi mathvariant="normal">/</mi><mi>R</mi></mrow><mrow><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mi>L</mi><mi mathvariant="normal">/</mi><mi>R</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">.</mi><mn>008</mn></mrow><mrow><mn>30</mn><mo>+</mo><mi mathvariant="normal">.</mi><mn>008</mn></mrow></mfrac><mo>=</mo><mi mathvariant="normal">.</mi><mn>00027</mn></mrow><annotation encoding="application/x-tex">U_\text{sender}=\frac{L/R}{RTT+L/R}=\frac{.008}{30+.008}=.00027</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">sender</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">RTT</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">L</span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mtight">/</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">30</span><span class="mbin mtight">+</span><span class="mord mtight">.008</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">.008</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">.00027</span></span></span></span> where RTT is round trip time, L/R is transmission delay.</p>
<pre><code><code><div>L/R sender
 ^       \
 |        \
RTT       receiver
 |       /
 v      /
    sender
</div></code></code></pre>
<p>solution: use pipelining</p>
<ul>
<li><em>pipelining</em>: sender allows multiple in-flight, yet-to-be-acked packets
<ul>
<li>need to manage out-of-order packets</li>
<li>range of seq numbers must be increased</li>
<li>buffering at sender and/or receiver</li>
</ul>
</li>
</ul>
<p><em>go-back-N</em> pipelining:</p>
<ul>
<li>sender: 'window' of up to N, consecutive transmitted but unacked packets
<ul>
<li><em>cumulative ACK</em>: ACKs all packets up to, including seq number n
<ul>
<li>when receiving ACK(n), move window forward to begin at n+1</li>
</ul>
</li>
<li>timer for oldest in-flight packet</li>
<li>timeout(n): retransmit packet n and all higher seq # packets in window</li>
</ul>
</li>
</ul>
<pre><code><code><div>   send_base   next_seq_num
      v           v
||||||############[][][][][]-------
      ^--------------------^
         window size N

||: already ACKed
##: sent, not yet ACKed
[]: usable, not yet sent
--: not usable
</div></code></code></pre>
<ul>
<li>receiver:
<ul>
<li>ACK-only: always send ACK for correctly-received packet so far with highest seq number
<ul>
<li>may generate duplicate ACKs</li>
<li>need only remember recv_base</li>
</ul>
</li>
<li>when receiving out-of-order packet:
<ul>
<li>can discard or buffer it: implementation detail</li>
<li>re-ACK packet with highest in-order seq number</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code><code><div>    recv_base
        v
...|||||-XXX-----

||: received and ACKed
--: not received
XX: out of order and not ACKed
</div></code></code></pre>
<p>procedure:</p>
<p><img src="assets/w6_7.PNG" alt="img"></p>
<p><em>selective repeat</em> pipelining:</p>
<ul>
<li>receiver individually acks all correctly received packets
<ul>
<li>buffer out-of-order packets as needed</li>
</ul>
</li>
<li>sender times-out and retransmits individually for unacked packets
<ul>
<li>sender maintains timer for each unacked packet</li>
</ul>
</li>
<li>sender window has N consecutive sequence numbers; limits sequence numbers of sent, unacked packets</li>
</ul>
<pre><code><code><div>   send_base   next_seq_num
      v           v
||||||##||##||####[][][][][]-------
      ^--------------------^
         window size N

||: already ACKed
##: sent, not yet ACKed
[]: usable, not yet sent
--: not usable
</div></code></code></pre>
<ul>
<li>sender:
<ul>
<li>if next available seq # is in window, send packet</li>
<li>if packet n times out, resend it and restart timer</li>
<li>if ACK(n) in [sendbase, sendbase+N], mark packet n as received
<ul>
<li>if n is smallest unacked packet, advance window base to next unacked seq #</li>
</ul>
</li>
</ul>
</li>
<li>receiver:
<ul>
<li>if packet n in [recvbase, recvbase+N-1]:
<ul>
<li>send ACK(n)</li>
<li>buffer out-of-order packets</li>
<li>if in-order, deliver, and advance window to next not-yet-received packet</li>
</ul>
</li>
<li>if packet n in [recvbase-N, recvbase-1]: ACK(n)</li>
<li>otherwise, ignore</li>
</ul>
</li>
</ul>
<p>does this beat the 'requirement' that one should ack <em>newest</em> correctly received packet?</p>
<h1 id="week-7-feb-14">Week 7. Feb 14</h1>
<p><strong>eg.</strong> because we allow out-of-order packets, the typical seq # pool = window size + 1 will not work.</p>
<p>we have sequence numbers 0,1,2,3 and window size 3:</p>
<p><img src="assets/w7_1.PNG" alt="img"></p>
<p>solution: window should not be the more than half of the seq # pool.</p>
<h3 id="transport-control-protocol-tcp">transport control protocol (TCP)</h3>
<p><span id="transport-control-protocol"></span></p>
<ul>
<li>point-to-point</li>
<li>reliable, in-order byte stream: no 'message boundaries'</li>
<li>full duplex data: bi-directional flow in same connection
<ul>
<li>MSS: maximum segment size</li>
</ul>
</li>
<li>cumulative ACKs: upon receiving nth packet, we are sure packets before it are received</li>
<li>pipelining: congestion and flow control set window size</li>
<li>connection-oriented: handshaking initializes states before data exchange</li>
<li>flow controlled: sender do not overwhelm receiver</li>
</ul>
<p>TCP segment header:</p>
<p><img src="assets/w7_2.PNG" alt="img"></p>
<p>procedure:</p>
<p><img src="assets/w7_3.PNG" alt="img"></p>
<ul>
<li>TCP is duplex, so there is really no distinction between sender and receiver. they both act as sender and receiver so both of them have seq numbers.</li>
<li>seq numbers:
<ul>
<li>first ever packet: random sequence number</li>
<li><em>sequence number</em>: byte stream 'number' of first byte in segment's data</li>
<li>acknowledgements: sequence number of next byte expected from other side
<ul>
<li>cumulative ACK</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>how to handle out-of-order packets? the TCP spec does not restrict.</p>
<p>how to set TCP timeout values?</p>
<ul>
<li>should be longer than RTT, but RTT varies</li>
<li>too short: premature timeout, unnecessary retransmission</li>
<li>too long: slow reaction to packet loss</li>
<li><em>sample RTT</em>: a way to estimate RTT
<ul>
<li>measured time from segment transmission until ACK receipt
<ul>
<li>ignore retransmissions</li>
</ul>
</li>
<li>it will vary, we want it smoother: measure average several recent values, not just current value</li>
<li><code>EstimatedRTT = (1- a)*EstimatedRTT + a*SampleRTT</code> = estimated RTT + 'safety margin'</li>
<li><code>DevRTT = (1-b)*DevRTT + b*|SampleRTT-EstimatedRTT|</code> (typically b=.25)</li>
</ul>
</li>
</ul>
<p>TCP sender (simplified):</p>
<ul>
<li>when data received from app:
<ul>
<li>create segment with seq #</li>
<li>seq # is byte-stream number of first data byte in segment</li>
<li>start time if not already started
<ul>
<li>think of timer as for oldest unacked packet</li>
<li>expiration interval: <code>TimeOutInterval</code></li>
</ul>
</li>
</ul>
</li>
<li>when timeout:
<ul>
<li>retransmit timed-out packet</li>
<li>restart timer</li>
</ul>
</li>
<li>when ACK received:
<ul>
<li>if ACK acknowledges previously unacked segments:
<ul>
<li>update what is known to be ACKed</li>
<li>start timer if there are still unacked segments</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>TCP receiver;</p>
<ul>
<li>when received in-order segment with expected seq #, and all data up to expected seq # is already acked
<ul>
<li>delays ACK. wait up to 500ms for next segment.</li>
<li>if no next segment, send ACK</li>
</ul>
</li>
<li>when received in-order segment with expected seq #, one other segment has ACK pending
<ul>
<li>immediately send single cumulative ACK, acking both in-order segments</li>
</ul>
</li>
<li>when received out-of-order segment higher-than-expect seq #
<ul>
<li>gap detected</li>
<li>immediately send duplicate ACK indicating seq # of next expected byte</li>
</ul>
</li>
<li>when received segment that partially/completely fills gap
<ul>
<li>immediately send ACK, provided that segment starts at lower end of gap</li>
</ul>
</li>
<li>when received out-of-order segment lower-than-expect seq #
<ul>
<li>send cumulative ACK, ignore</li>
</ul>
</li>
</ul>
<p><img src="assets/w7_4.PNG" alt="img"></p>
<p>TCP fast retransmit:</p>
<ul>
<li>if sender receives 3 additional ACKs for same data, resend unacked segment with smallest seq #</li>
<li>without waiting for counter</li>
<li>(3 duplicate ACKs likely implies lost segments)</li>
</ul>
<p>TCP flow control:</p>
<ul>
<li>TCP receiver specifies free buffer space in <code>rwnd</code> field in TCP header
<ul>
<li><code>RcvBuffer</code> size set via socket options (default 4096)</li>
<li>many OS autoadjust <code>RecvBuffer</code></li>
</ul>
</li>
<li>sender limits amount of unacked data to received <code>rwnd</code></li>
<li>this guarantees receive buffer will not overflow if network layer delivers data faster than app layer removes data from socket buffers</li>
<li>what happens if <code>rwnd</code> is 0 and sender receives no further packets?
<ul>
<li>try sending a very tiny packet instead of not doing anything</li>
</ul>
</li>
</ul>
<p>TCP connection management:</p>
<ul>
<li>before exchanging data, two parties handshake
<ul>
<li>agree to establish connection</li>
<li>agree on connection parameters (initial seq #)</li>
</ul>
</li>
</ul>
<p><em>3-way handshake</em>:</p>
<p><img src="assets/w7_5.PNG" alt="img"></p>
<p>SYN flood attack:</p>
<ul>
<li>client may flood with ACK packets to make server create connections</li>
<li>how does server generate y after receiving client SYN? server uses x + some secret + server IP to create random number as y. after receiving another ACK, use the same info to recalculate it to check whether the message is legitimate.</li>
</ul>
<p>close of connection:</p>
<ul>
<li>can be initiated by server or client</li>
</ul>
<p><img src="assets/w7_6.PNG" alt="img"></p>
<h1 id="week-9-feb-28">Week 9. Feb 28</h1>
<h3 id="principles-of-congestion-control">principles of congestion control</h3>
<p>too many sources sending too much data too fast for network to handle.</p>
<p>manifestations:</p>
<ul>
<li>long delays (primarily queueing in router buffers)</li>
<li>packet losses (buffer overflow at routers)</li>
</ul>
<p>causes of congestion:</p>
<ul>
<li>premature timeout causes retransmission =&gt; unneeded duplicates
<ul>
<li>the output throughput is below the maximum (R/2) as it drops duplicates</li>
<li>the more packet sent, the more probability for duplicates</li>
</ul>
</li>
</ul>
<p><img src="assets/w9_1.PNG" alt="img"></p>
<ul>
<li>another cost of congestion: when packet is dropped, any upstream transmission capacity and buffering used for that packet was wasted</li>
</ul>
<p><img src="assets/w9_2.PNG" alt="img"></p>
<p>approaches:</p>
<ul>
<li><em>end-end congestion control</em>:
<ul>
<li>no explicit feedback from network</li>
<li>congestion inferred from observed loss and delay</li>
</ul>
</li>
<li><em>network-assisted congestion control</em>:
<ul>
<li>routers provide direct feedback to sending and receiving hosts with flows passing through congested router</li>
<li>may indicate congestion level or explictly set sending rate</li>
<li>TCP ECN, ATM, DECbit</li>
</ul>
</li>
</ul>
<h3 id="tcp-congestion-control-aimd-tcp-reno">TCP congestion control: AIMD (TCP reno)</h3>
<p>approach: senders can increase sending rate until packet loss occurs, then decrease rate on loss events.</p>
<ul>
<li>generally increase window size by a segment every RTT</li>
<li>shrink window size by dividing by 2 on loss</li>
</ul>
<p><img src="assets/w9_3.PNG" alt="img"></p>
<ul>
<li><em>multiplicative decrease</em>:
<ul>
<li>rate is cut in half when loss is detected by triple duplicate ACKs (TCP reno)
<ul>
<li>it means eventually congestion resolved</li>
</ul>
</li>
<li>cut to 1 <em>MSS (maximum segment size)</em> when loss detected by timeout (TCP tahoe)
<ul>
<li>it means congestion is heavy</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>benefits: a distributed, asynchronous algorithm has been shown to</p>
<ul>
<li>optimize congested flow rates network wide</li>
<li>have desirable stability properties</li>
</ul>
<p>sending bahavior:</p>
<ul>
<li>roughly: send <code>cwnd</code> bytes, wait RTT for ACKs, then send more bytes
<ul>
<li>TCP rate ~ <code>cwnd</code> / RTT bytes/s</li>
<li>where <code>cwnd</code> is dynamically adjusted window size</li>
</ul>
</li>
<li>TCP sender limits transmission <code>LastByteSend - LastByteAcked &lt;= cnwd</code></li>
</ul>
<p>TCP slow start:</p>
<ul>
<li>when connection starts, we increase rate exponentially
<ul>
<li>initially <code>cwnd</code> = 1 MSS</li>
<li>then double <code>cwnd</code> every RTT
<ul>
<li>done by incrementing <code>cwnd</code> for every ACK received</li>
</ul>
</li>
</ul>
</li>
<li>variable <code>ssthresh</code> (slow start threshold) used as threshold to switch to linear from exponential
<ul>
<li>on loss event, <code>ssthresh</code> is set to <code>cwnd</code> / 2 just before loss event</li>
</ul>
</li>
<li>depending on whther timeout or dup ACKs we do differently</li>
</ul>
<p><img src="assets/w9_4.PNG" alt="img"></p>
<p>[RFC 5681]</p>
<p><img src="assets/w9_5.PNG" alt="img"></p>
<h3 id="explicit-congestion-notification">explicit congestion notification</h3>
<p>example of network-assisted congestion control.</p>
<ul>
<li>when packet is sent, two bits in IP header (ToS field) is marked by network router to indicate congestion (changed from 10 to 11)
<ul>
<li>this indication is carried to destination</li>
</ul>
</li>
<li>destination's response sets ECE bit to 1 on ACK segment to notify sender of congestion</li>
<li>this involves both IP (IP header ECN bit marking) and TCP (TCP header's C,E bit marking)</li>
</ul>
<p><img src="assets/w9_6.PNG" alt="img"></p>
<h3 id="fairness-of-tcp">fairness of TCP</h3>
<p>goal: if k TCP sessions share same bottleneck link of bandwith R, each should have average rate R/K.</p>
<p>consider two competing TCP sessions only in AIMD congestion avoidance mode, with same MSS and RTT, and so same throughput.</p>
<ul>
<li>additive increase giives slope of 1 as throughput increases</li>
<li>multiplicative decrease decreases throughput proportionally</li>
</ul>
<p><img src="assets/w9_7.PNG" alt="img"></p>
<p>the red path swings around the max bandwidth line and eventually converges to the equal bandwidth line. so TCP under these assumptions is fair.</p>
<p>is UDP fair?</p>
<ul>
<li>multimedia apps often do not use TCP &lt;= do not want rate throttled by congestion control</li>
<li>they use UDP to send files at constant rate and tolerate packet loss</li>
<li>they impact other TCP connections on the same bottleneck link</li>
<li>there is no 'internet police' enforcing congestion control</li>
</ul>
<p>is parallel TCP connections fair?</p>
<ul>
<li>party that has more parallel connections will have advantage</li>
</ul>
<h3 id="tcp-cubic">TCP CUBIC</h3>
<p>intuition:</p>
<ul>
<li>let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mtext>max</mtext></msub></mrow><annotation encoding="application/x-tex">W_{\text{max}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be sending rate at which congestion loss was detected</li>
<li>congestion state of bottleneck link probably has not changed much</li>
<li>after cutting rate/windows in half on loss, initially ramp to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mtext>max</mtext></msub></mrow><annotation encoding="application/x-tex">W_{\text{max}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> faster, and then approach <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mtext>max</mtext></msub></mrow><annotation encoding="application/x-tex">W_{\text{max}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> slowly</li>
</ul>
<p><img src="assets/w9_8.PNG" alt="img"></p>
<ul>
<li>let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> point in time when TCP window size reaches <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mtext>max</mtext></msub></mrow><annotation encoding="application/x-tex">W_{\text{max}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, it is tunable
<ul>
<li><code>cwnd = c * t-K^3+Wmax</code> where <code>c</code> is usually 0.4, where t is time of current loss</li>
</ul>
</li>
<li>increases <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> as function of the cube of the distance between current time and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>
<ul>
<li>larger increases when further away from K</li>
<li>smaller increases when nearer to K</li>
</ul>
</li>
</ul>
<p>TCP CUBIC is default in linux and is most popular in web servers.</p>
<h3 id="history">history</h3>
<p>TCP and UDP are principal transport protocols for 40 years.</p>
<p>there are different flavors of TCP developed for specific scenerios:</p>
<table>
<thead>
<tr>
<th style="text-align:left">case</th>
<th style="text-align:left">challenges</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">long, fat pipes</td>
<td style="text-align:left">many packets in flight; loss shuts down pipeline</td>
</tr>
<tr>
<td style="text-align:left">wireless networks</td>
<td style="text-align:left">loss due to noisy wireless links, mobility; TCP treats this as congestion loss</td>
</tr>
<tr>
<td style="text-align:left">long-delay links</td>
<td style="text-align:left">long RTTs</td>
</tr>
<tr>
<td style="text-align:left">data center networks</td>
<td style="text-align:left">latency sensitive</td>
</tr>
<tr>
<td style="text-align:left">background traffic flows</td>
<td style="text-align:left">low priority; 'background' TCP flows</td>
</tr>
</tbody>
</table>
<p>now: moving transport-layer functions to app layer on top of UDP: HTTP/3: QUIC</p>
<h3 id="quic-quick-udp-internet-connections">QUIC (quick UDP internet connections)</h3>
<p>app-layer protocol on UDP</p>
<ul>
<li>better HTTP performance</li>
<li>used by google</li>
<li>error and congestion control: 'similar to well-known TCP ones'</li>
<li>connection establishment: reliability, congestion control, euthentication, encryption, state established in one RTT
<ul>
<li>unlike TCP+TLS that require two handshakes</li>
</ul>
</li>
<li>multiple app-level 'streams' multiplexed over single QUIC connection
<ul>
<li>separate reliable data transfer, security</li>
<li>common congestion control</li>
<li>no head-of-line blocking</li>
</ul>
</li>
</ul>
<p><img src="assets/w9_9.PNG" alt="img"></p>
<p>moving from network edge to network core...</p>
<h1 id="week-10-mar-7">Week 10. Mar 7</h1>
<h2 id="network-layerdata-plane">network layer/data plane</h2>
<ul>
<li>it is in every internet device: hosts and routers</li>
<li>router: examines header fields in IP datagrams passing through it and moves from input port them to output port along end-end path.</li>
<li><a href="#routing-forwarding">routing and forwarding</a></li>
</ul>
<p>planes:</p>
<ul>
<li><em>data plane</em>: local, per-router function
<ul>
<li>determines how datagram arriving on router input is forwarded ti router output port</li>
</ul>
</li>
<li><em><a href="#network-layer-control-plane">control plane</a></em>: network-wide logic
<ul>
<li>determines how datagram is routed among routers along end-end path from src host to dst host</li>
<li>traditional routing algorithm: implemented in routers
<ul>
<li>each router has forwarding table</li>
<li>individual routing algo components in each and every router interact in the control plane to determine optimal host</li>
<li>or only know information with its neighbors</li>
</ul>
</li>
<li><em>software-defined networking (SDN)</em>: implemented in (remote) servers
<ul>
<li>remote controller computers installs forwarding tables in routers</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>service model for channel transporting datagrams</p>
<ul>
<li>for individual datagrams:
<ul>
<li>guaranteed delivery</li>
<li>delivery within some time</li>
</ul>
</li>
<li>for flow of datagrams:
<ul>
<li>delivery in order</li>
<li>guaranteed minimum bandwidth to flow</li>
<li>restrictions on changes in interpacket spacing (jitter)</li>
</ul>
</li>
<li>IP protocol does not support any of them (best effort)</li>
</ul>
<h3 id="routers">routers</h3>
<pre><code><code><div>                             +-------------+
                             | routing     |                                routing, management
                    +--------+ processor   |                                control plane (software)
                    |        +-------------+                                operates in ms time frame
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
                    |                                                       forwarding data plane
      +-------------v-+     +-------------+     +----------------+         (hardware) operates
  +---|---|-----|-----|----&gt;+             +-----|---|-----|------|-----&gt;   in ns timeframe
      +---------------+     |             |     +----------------+
                    |       |  high-speed |
                    |       |  switching  |
                    |       |  frabric    |
                    |       |             |
      +-------------v--+    |             |     +----------------+
  +---|---|-----|------|----&gt;+            +-----|---|-----|------|-----&gt;
      +----------------+    +-------------+     +----------------+

       input ports                                 output ports
</div></code></code></pre>
<p>input port:</p>
<pre><code><code><div>   +----------------------------------------------------------------+
   |                                                                |
   |  +-------------+      +---------------+     +---------------+  |
   |  |    line     |      | link layer    |     | lookup,forward|  |    switch
+----&gt;+ termination +------&gt; protocol (rcv)+-----&gt; queueing      +----&gt;  fabric
   |  +-------------+      +---------------+     |   ||||||||||  |  |
   |                                             +---------------+  |
   +----------------------------------------------------------------+
</div></code></code></pre>
<ul>
<li>line term: physical layer, bit-level reception</li>
<li>link layer: eg ethernet</li>
<li>decentralized switching:
<ul>
<li>using header field values, look up output port using forwarding table in input port memory ('match + action')</li>
<li>goal: complete input port processing at line speed</li>
<li><em>input port queueing</em>: if datagrams arrive faster than forwarding rate into switch fabric</li>
<li><em>destination-based forwarding</em>: forward based only on dest IP (traditional)</li>
<li><em>generalized forwarding</em>: forward based on any set of header field values</li>
</ul>
</li>
</ul>
<p><em>longest prefix matching</em>: when looking for forwarding table entry gor given dest address, use longest address prefix that matches dest address</p>
<pre><code><code><div>range                                  line interface
-----------------------------------------------------
11001000 00010111 00010*** ******** -&gt; 0
11001000 00010111 00011000 ******** -&gt; 1
</div></code></code></pre>
<ul>
<li>often performed using ternary content addressable memories (TCAMs)
<ul>
<li><em>content addressable</em>: present address to TCAM: retrieve address in one clock cycle regardless of table size</li>
</ul>
</li>
</ul>
<p>switching fabrics:</p>
<ul>
<li>transfer packet from input link to output link</li>
<li><em>switching rate</em>: rate at which packets can be transferred
<ul>
<li>often measured as multiple of input/output line rate</li>
<li>N input =&gt; switching rate of N * line rate is desirable</li>
</ul>
</li>
<li>head-of-line blocking (HOL): queued datagrams in front of queue block others</li>
</ul>
<p>output port queueing:</p>
<pre><code><code><div>     +-----------------------------------------------------------------+
     |                                                                 |
     |  +----------------+      +----------------+     +-------------+ |
     |  | lookup,forward |      | link layer     |     |  line       | |
NR  ---&gt;+ queueing       +------&gt; protocol (send)+-----&gt; termination +------&gt; rate R
     |  |  --||||||||||  |      +----------------+     +-------------+ |
     |  +----------------+                                             |
     +-----------------------------------------------------------------+
</div></code></code></pre>
<ul>
<li>buffering is required when datagrams arrive from fabric is faster than link transmission rate.</li>
<li><em>drop policy</em>: which datagram to drop if no free buffers? network neutrality vs pirority dropping</li>
<li>scheduling discipline chooses among queued datagrams for transmission</li>
<li>RFC 3439 rule of thumb: average buffering equal to 'typical' RTT times link capacity R</li>
<li>too much bufferng can increase delays (particularly in home routers): long RTTs</li>
</ul>
<p>buffer management:</p>
<ul>
<li><em>drop</em>: tail drop (drop arriving packet) and priority (drop on priority basis)</li>
<li><em>marking</em>: which packets to mark to signal congestion (ECN, RED header fields)</li>
</ul>
<p>packet scheduling: decide which packet to send next on link</p>
<ul>
<li>FCFS/FIFO: packets transmitted in order of arrival</li>
<li>priority scheduling: arriving traffic is classigied, queued by class
<ul>
<li>any header fields can be used for classification</li>
<li>FCFS within priority class</li>
</ul>
</li>
<li><em>round-robin</em>: also have classes
<ul>
<li>erver cycically, repeatedly scans class queues, sending one complete packet from each class</li>
</ul>
</li>
<li><em>weight fair queueing (WFQ)</em>: generalized round robin
<ul>
<li>each class <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> with weight <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> gets weighted amount of service in each cycle <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>w</mi><mi>i</mi></msub><mrow><msub><mo>∑</mo><mi>j</mi></msub><msub><mi>w</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{w_i}{\sum_j w_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3787em;vertical-align:-0.6672em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1496em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4603em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6672em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
</li>
</ul>
<h3 id="internet-protocol">internet protocol</h3>
<p><img src="assets/w10_1.PNG" alt="img"></p>
<ul>
<li>IP version is 4</li>
<li>'type' of service used to for prioritization etc...</li>
<li>IP checksum only computed on header, unlike TCP/UDP checksum that is computed on entire packet. because TTL changes in routing, it must be recalculated each time.</li>
</ul>
<p>ip fragmentation and reassembly:</p>
<ul>
<li>the max size of the datagram will be limited by MTU (maximum transmission unit), up to the underlying technology (ethernet, wifi...)</li>
<li>large IP datagrams divided into several datagrams</li>
<li>fragments can take different paths</li>
<li>they are assemblied only at destination</li>
<li><code>[HIP HTCP ...|.......|...] =&gt; [HIP HTCP ..][HIP  .......][HIP  ...]</code></li>
<li>ip headers are used to identify and re-order them
<ul>
<li>(will not work using serial number) so use offset</li>
</ul>
</li>
<li>overhead exists: timer, waiting for expected fragment, ...</li>
</ul>
<p>addressing</p>
<ul>
<li><em>ip address</em>: 32 bits associated with each host or router interface</li>
<li><em>interface</em>: connection between host/router and physical link
<ul>
<li>routers typically have multiple interfaces (belonging to different subnets)</li>
<li>host typically has one or two interfaces</li>
</ul>
</li>
</ul>
<p>subnets:</p>
<ul>
<li><em>subnets</em>: device interfaces that can physically reach each other  without passing through an intervening router</li>
<li>IP address have two parts:
<ul>
<li>subnet part: devices in same subnet have common high order bits</li>
<li>host part: remaining low order bits</li>
</ul>
</li>
<li>subnets are defined by address and mask</li>
<li><em>classless interdomain routing (CIDR)</em>: <code>223.1.1.0/24</code> where /24 is number of bits in subnet portion of address</li>
<li>classical: <code>223.1.1.0; subnet mask: 255.255.255.0</code></li>
</ul>
<pre><code><code><div>subnet:      1101 1111  0000 0001  0000 0001  0000 0000
             -------------------------------
subnet mask: 1111 1111  1111 1111  1111 1111  0000 0000
</div></code></code></pre>
<ul>
<li>before classless, there were classful ip addresses where subnet mask matters and there are only 8, 16, 24, ...</li>
</ul>
<p>how to get an IP address:</p>
<ul>
<li>how hosts get IP address within its subnet
<ul>
<li>hard-coded by sysadmin</li>
<li>or by <em>DHCP (dynamic host configuration protocol)</em> get address from server</li>
</ul>
</li>
<li>how network get its own address?
<ul>
<li>subnet part: it gets allocated portion of its provider ISP's address space</li>
</ul>
</li>
<li>how do ISP get IP blocks? by ICANN (which allocates IP addresses through 5 regional registries)</li>
</ul>
<p>DHCP: host dynamically obtains IP from network server when it joins network</p>
<ul>
<li>can renew its lease on address in use
<ul>
<li>server will recycle addresses</li>
</ul>
</li>
<li>allows reuse of addresses (only hold address while connected/on)</li>
<li>support for mobile users who join/leave network</li>
<li>steps:
<ul>
<li>host broadcasts DHCP discover message
<ul>
<li>every interface card listens to broadcast address</li>
</ul>
</li>
<li>DHCP server responds with DHCP offer message</li>
<li>host requests IP with DHCP request message</li>
<li>DHCP server sends DHCP ack message</li>
</ul>
</li>
<li>it also returns address of first-hop router for client, name and IP address of DNS server, and network mask</li>
</ul>
<h1 id="week-11-mar-14">Week 11. Mar 14</h1>
<p>hierarchical addressing:</p>
<ul>
<li>not all routers need to know other blocks in their routing table</li>
<li>route aggregated by routers (ISP's)
<ul>
<li>thanks to longest prefix matching we can use prefix to ask 'recursively' along the path for which router is for which IP</li>
</ul>
</li>
<li>allows efficient advertisement of routing information</li>
</ul>
<p>are there enough 32-bit IP addresses?</p>
<ul>
<li>ICANN allocated last chunk of IPv4 addresses to RRs in 2011</li>
<li>NAT helps IPv4 address space exhaustion</li>
<li>IPv6 has 128-bit address space</li>
</ul>
<h3 id="network-address-translation-nat">network address translation (NAT)</h3>
<p><em>NAT</em>: all devices in local network share just one IPv4 address as far as outside world is connected</p>
<pre><code><code><div>                          10.0.0.4      ---- PC (10.0.0.1)
------------------------ |x|  ----      ---- PC (10.0.0.2)
      138.2.17.66                       ---- PC (10.0.0.3)

&lt;----------------------&gt;    &lt;----------------------------&gt;
    INETERNET                      LOCAL NETWORK
all datagrams leaving        datagrams with src or dest
local network have           in this network have local
same src IP but              addresses
different ports
</div></code></code></pre>
<ul>
<li>all devices in local network have 32-bit addresses in a private IP address space that can only be used in local network (10/8, 172.16/12, 192.168/16)</li>
<li>advantages
<ul>
<li>just one IP needed from provider ISP for all providers</li>
<li>can change addresses of host in local network without notifying outside world</li>
<li>an change ISP without changing local address</li>
<li>security: devices inside local net not directly addressable, visible  by outside world</li>
</ul>
</li>
</ul>
<p>implementation (transparently):</p>
<ul>
<li>outgoing datagrams: replace <code>source IP:port</code> of every outgoing datagram to <code>NAT IP address:new port</code></li>
<li>remember (in NAT translation table) every <code>source IP:port</code> to <code>NAT IP address:new port</code> translation pair</li>
<li>incoming datagrams: replace <code>NAT IP address:new port</code> in destination fields of every incoming datagram with corresponding <code>source IP:port</code> stored in NAT table</li>
<li>recalculation of checksum for transport and network layers needed</li>
</ul>
<p>controversy:</p>
<ul>
<li>routers 'should only' process up to layer 3 (network)</li>
<li>violates end-to-end argument (port # manipulation by network-layer device)</li>
<li>it is delaying deployment of IPv6...</li>
<li>NAT traversal: what if client wants to connect to server behind NAT?</li>
<li>but it is extensively used in home and instutional networks, cellular nets</li>
</ul>
<h3 id="ipv6">IPv6</h3>
<p>motivations:</p>
<ul>
<li>IPv4 shortage</li>
<li>speed processing/forwarding 40-byte fixed length header</li>
<li>enable different network-layer treatment of flows</li>
</ul>
<p><img src="assets/w11_1.PNG" alt="img"></p>
<ul>
<li>no checksum, fragmentation/reassembly,</li>
<li>or options (which are available as upper-layer, next-header protocol at router, so they are in 'payload')</li>
</ul>
<p>transition from IPv4:</p>
<ul>
<li>network operate with mixed IPv4 and IPv6 routers</li>
<li><em>tunneling</em>: IPv6 datagrams are carried as payload in IPv4 datagram among IPv4-only routers
<ul>
<li>needs admin to configure manually</li>
<li>used extensively in other contexts (4G/5G)</li>
</ul>
</li>
</ul>
<h3 id="generalized-forwarding">generalized forwarding</h3>
<ul>
<li><em>'match plus action'</em> abstraction: match bits in arriving packet, take action</li>
<li><em>destination-based forwarding</em>: forward based on dest address</li>
<li><em>generalized forwarding</em>: many header fields can be used to determine action
<ul>
<li>drop/copy/modify/log matched packet, or send packet to controller</li>
</ul>
</li>
</ul>
<p><em>flow table</em>:</p>
<ul>
<li>in this case, routing table is no longer simply a routing table</li>
<li><em>flow</em>: determined by header (in link, network, transport-layer fields)</li>
<li>simple packet-handling rules:
<ul>
<li><code>match</code></li>
<li><code>action</code></li>
<li><em>priority</em>: to disambiguate overlapping matches</li>
<li><em>counters</em>: # bytes and # packets</li>
</ul>
</li>
</ul>
<p>OpenFlow:</p>
<pre><code class="language-yaml"><div><span class="hljs-attr">match:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">ingress</span> <span class="hljs-string">port</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">link layer:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">src</span> <span class="hljs-string">MAC</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">dst</span> <span class="hljs-string">MAC</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EtherType</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">VLAN</span> <span class="hljs-string">ID</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">VLAN</span> <span class="hljs-string">Pri</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">network layer:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">src</span> <span class="hljs-string">IP</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">dst</span> <span class="hljs-string">IP</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">IP</span> <span class="hljs-string">protocol</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">IP</span> <span class="hljs-string">ToS</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">transport layer:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">TCP/UDP</span> <span class="hljs-string">src</span> <span class="hljs-string">port</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">TCP/UDP</span> <span class="hljs-string">dst</span> <span class="hljs-string">port</span>
<span class="hljs-attr">action:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">forward</span> <span class="hljs-string">to</span> <span class="hljs-string">port</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">drop</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">modify</span> <span class="hljs-string">fields</span> <span class="hljs-string">in</span> <span class="hljs-string">header</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">encapsulate</span> <span class="hljs-string">and</span> <span class="hljs-string">forward</span> <span class="hljs-string">to</span> <span class="hljs-string">controller</span>
<span class="hljs-attr">stats:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">packet</span> <span class="hljs-string">counter</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">byte</span> <span class="hljs-string">counter</span>
</div></code></pre>
<p>match+action abstraction unifies different kinds of devices:</p>
<ul>
<li>router
<ul>
<li>match: longest dst IP prefix</li>
<li>action: forward out a link</li>
</ul>
</li>
<li>switch
<ul>
<li>match: dst MAC</li>
<li>action: forward or flood</li>
</ul>
</li>
<li>firewall
<ul>
<li>match: IP and TCP/UDP ports</li>
<li>action: permit/deny</li>
</ul>
</li>
<li>NAT
<ul>
<li>match: IP and port</li>
<li>action: rewrite address and port</li>
</ul>
</li>
</ul>
<p>many of these tables combined can have network-wide behaviors, which is a simple form of 'network programmability'</p>
<ul>
<li>programmable, per-packet programming</li>
<li>hostorical roots: active networking</li>
<li>today: more generalized programming P4</li>
</ul>
<h2 id="network-layercontrol-plane">network layer/control plane</h2>
<span id="network-layer-control-plane" />
<h3 id="routing-protocols">routing protocols</h3>
<p>routing algorithm goal: determine 'good' paths from src to dst.</p>
<ul>
<li><em>path</em>: sequence of routers that packet traverse from source host to dst host</li>
<li>'good': least cost, fastest, or least congested</li>
</ul>
<p>routing algorithm classifications:</p>
<pre><code><code><div>                                 global: all routers have complete
                                 topology, link cost info
                                 * 'link state' algos
                                           ^
                                           |
                                           |
                                           |
static: routers change                     |                  &quot;dynamic&quot;: routers change
slowly over time       +-------------------+----------------&gt; more quickly
                                           |                  * periodic updates or
                   how fast routers        |                    in response to link
                   change?                 |                    cost change
                                           |
                                           |
                                           +  global or decentralized info?

                                  decentralized: iterative process
                                  of computation, exchange of info
                                  with neighbors
                                  * routers initially only know link
                                    costs to  attached neighbors
                                  * 'distance vector' algos
</div></code></code></pre>
<p>graph notations:</p>
<ul>
<li>graph <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G=(V,E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> can be directed or undirected</li>
<li><em>cost of direct link</em> connecting a and b: is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><msub><mi>w</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mtext> if </mtext><mi>a</mi><mi>b</mi><mo>∈</mo><mi>E</mi><mtext> else </mtext><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">c_{ab}=w_{ab}\text{ if }ab\in E\text{ else }\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ab</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ab</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord"> if </span></span><span class="mord mathnormal">ab</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord text"><span class="mord"> else </span></span><span class="mord">∞</span></span></span></span>
<ul>
<li>cost is defined by network operator, can be inversely related to bandwith or related to congestion</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>: current estimate of cost of least-cost-path from src to dst</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>: predecessor node along path from source to v</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>N</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">N&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>: set of nodes whose least-cost-path definitively known</li>
</ul>
<p><em>Dijkstra's link-state routing algorithm</em>:</p>
<ul>
<li>centralized: link costs known to all nodes
<ul>
<li>achieved via 'link state broadcast'</li>
<li>all nodes have same info</li>
</ul>
</li>
<li>computes least cost paths from one node ('src') to all other nodes
<ul>
<li>giving forwarding table for that node</li>
</ul>
</li>
<li>iterative: after k iterations, we know least-cost-paths to k destinations</li>
</ul>
<pre><code class="language-cpp"><div><span class="hljs-keyword">auto</span> N<span class="hljs-number">&#x27;</span> = {u}
<span class="hljs-keyword">for</span> v in V:
    <span class="hljs-keyword">if</span> vu in E:
        D[v] = c[uv]
    <span class="hljs-keyword">else</span>:
        D[v] = infty

<span class="hljs-keyword">while</span> N<span class="hljs-number">&#x27;</span> != V:
    <span class="hljs-keyword">auto</span> w = such that D[w] = min{D[w] <span class="hljs-keyword">for</span> w in V-N<span class="hljs-number">&#x27;</span>}
    N<span class="hljs-number">&#x27;.</span><span class="hljs-built_in">add</span>(w)
    <span class="hljs-keyword">for</span> v in w.neighbors - N<span class="hljs-number">&#x27;</span>:
        D[v] = min{D[v], D[w] + c[wv]}
</div></code></pre>
<p>the forwarding table is the least cost tree built by Dijkstra's algorithm.</p>
<p><img src="assets/w11_2.PNG" alt="img"></p>
<ul>
<li>algo complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. more efficient implementations possible <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|\log|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>.</li>
<li>message complexity: each router must broadcast its link state info to other <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|V|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">∣</span></span></span></span> routers</li>
<li>efficient broadcast algos: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span> link crossings to disseminatea broadcast message from one source</li>
<li>each router's message crosses O(|V|) links: overall message complexity <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>osciilation: when a router changes info, since other routers compute path tree as soon as they receive new states, all routers will run the algo...</p>
<ul>
<li>solution: let router wait for a while before computing new path tree</li>
</ul>
<h1 id="week-12-mar-21">Week 12. Mar 21</h1>
<p><em>distance vector algorithm</em>:</p>
<ul>
<li>based on bellman-ford algorithm instead: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>v</mi><mo>∈</mo><mtext>neighbours</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">{</mo><msub><mi>c</mi><mrow><mi>x</mi><mi>v</mi></mrow></msub><mo>+</mo><msub><mi>D</mi><mi>v</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">D_x(y)=\min_{v\in\text{neighbours}(x)}\{c_{xv}+D_v(y)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord text mtight"><span class="mord mtight">neighbours</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">xv</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)}</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_x(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> is cost of least-cost path from x to y (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">D_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is &quot;distance vector&quot; of x)</li>
<li>key idea:
<ul>
<li>from time to time, each node sends its own distance vector estimate to its neighbors</li>
<li>when a node receives a distance vector estimate from a neighbor, it updates its own distance vector estimate</li>
<li>under minor and natural assumptions the estimates converge to real values
<ul>
<li>how to know convergence? neighbor sends estimate but this node's value does not change</li>
</ul>
</li>
</ul>
</li>
<li>x stores the 'distance table'</li>
<li>iterative and asynchronous: each local iteration is caused by local link cost change or message from neighbor</li>
<li>distributed and self-stopping: no notification received =&gt; no action</li>
</ul>
<pre><code><code><div>while True:
    wait for change in local link cost or message from neighbor
    recompute DV estimates using DV received from neighbor
    if DV to any destination has changed, notify neighbours
</div></code></code></pre>
<p>state information diffusion: at iteration i, x's state influences distance computations up to i hops away</p>
<p><img src="assets/w12_1.PNG" alt="img"></p>
<p><strong>eg.</strong> 'good news travels fast' when link cost decreases</p>
<pre><code><code><div>C[xy] = 4  -&gt; decreased to 1
C[xz] = 50
C[yz] = 1

+----- y -----+
| 4         1 |
x ----------- z
       50
</div></code></code></pre>
<ol>
<li>y detects link-cost change, updates its DV, informs its neighbors</li>
<li>z receives update from y, updates its table, computes new least cost to x , sends its neighbors its DV.</li>
<li>y receives z’s update, updates its distance table. y’s least costs do not change, so y does not send a message to z. (converged)</li>
</ol>
<p><strong>eg.</strong> 'bad news travels slow' when link cost increases</p>
<pre><code><code><div>C[xy] = 4  -&gt; increased to 60
</div></code></code></pre>
<ol>
<li>y sees direct link to x has new cost 60, but z has said it has a path to x at cost of 5. So y computes “my new cost to x will be 6, via z); then notifies z of new cost of 6 to x</li>
<li>z learns that path to x via y has new cost 6, so z computes “my new cost to
x will be 7 via y), notifies y of new cost of 7 to x</li>
<li>y learns that path to x via z has new cost 7, so y computes “my new cost to
x will be 8 via y), notifies z of new cost of 8 to x</li>
<li>...</li>
</ol>
<p>this is 'count-to-infinity problem'. while the algo does not yet converge, the datagram from y to x may go back and forth between y and z.. <em>(black holing)</em></p>
<p><em>reverse poisoning</em>: node y can lie to its neighbour in the message that it has infinity distance so packet will not come back.. but this is not good for all situations as we can have bigger loops.</p>
<ul>
<li>we can also set a counter that alerts</li>
</ul>
<p>comparisons</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">LS</th>
<th style="text-align:left">DV</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">message complexity</td>
<td style="text-align:left">O(n^2) messages sent</td>
<td style="text-align:left">exchange between neighbours<br />varies convergence times</td>
</tr>
<tr>
<td style="text-align:left">speed of convergence</td>
<td style="text-align:left">O(n^2)<br /> may have oscillations</td>
<td style="text-align:left">varies<br />may have routing loops and<br />count-to-infty problem</td>
</tr>
<tr>
<td style="text-align:left">robustness<br />what if router malfunctions?</td>
<td style="text-align:left">router can advertise incorrect cost<br />each router computes its own tabe</td>
<td style="text-align:left">DV router can advertise incorrect path cost or black holing<br />errors propogates through network</td>
</tr>
</tbody>
</table>
<h3 id="intra-domain-routing-protocol">intra-domain routing protocol</h3>
<p>however in real world routers are different and they can have different bandwidths and routing algos..</p>
<p>scale: have billions of destinations</p>
<ul>
<li>cannot store all destinations in routing tables</li>
<li>routing table exchange would swamp links</li>
<li><em>administrative autonomy (AS)</em>: each nertwork admin may want to control routing in its own network
<ul>
<li>internet is network of networks</li>
</ul>
</li>
</ul>
<p>2 levels of routing:</p>
<ul>
<li><em>intra-AS (intra-domain)</em>: all routers in AS must run same intra-domain protocol
<ul>
<li>LS or DV</li>
<li><em>gateway router</em>: at edge of its own AS, has links to other AS's</li>
</ul>
</li>
<li><em>inter-AS (inter-domain)</em>: gateway perform inter-domain routing (as well as intra-domain)</li>
</ul>
<p>common intra-AS routing protocols:</p>
<ul>
<li>RIP (Routing Information Protocol) [RFC 1723]
<ul>
<li>classic DV: DVs exchanged every 30s</li>
<li>no longer widely used</li>
</ul>
</li>
<li>EIGRP (Enhanced Interior Gateway Routing Protocol) [RFC 7868]
<ul>
<li>DV based</li>
</ul>
</li>
<li>OSPF (Open Shortest Path First) [RFC 2328]
<ul>
<li>link-state routing</li>
<li>aall OSPF messages are euthenticated</li>
<li>IS-IS protocol is essentially same as OSPF</li>
<li>Hierarchical OSPF:
<ul>
<li>two-level hieracrhhy: local area and backbone</li>
<li>link-state advertisements flood only in area, or backbone</li>
<li>each node has detailed area topology; only knows direction to each other destinations</li>
<li>reduces number of forwarding table entry and number of messages</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="assets/w12_2.PNG" alt="img"></p>
<h3 id="inter-domain-routing-protocol-bgp">inter-domain routing protocol: BGP</h3>
<ul>
<li><em>BGP (Border Gateway Protocol)</em>: de facto inter-domain routing protocol</li>
<li>allows subnet to advertise its existence, and the destinations it can reach, to rest of the internet</li>
<li>BGP provides each AS a means to:
<ul>
<li><em>eBGP</em>: obtain subnet reachability information from neighboring ASes</li>
<li><em>iBGP</em>: propagate reachability information to all AS-internal routers.</li>
<li>determine good routes to other network based on reachability information and policy</li>
</ul>
</li>
</ul>
<p><img src="assets/w12_3.PNG" alt="img"></p>
<ul>
<li><em>BGP session</em>: two BGP routers (peers) exchange BGP messages over semi-permanent TCP connections
<ul>
<li>advertising paths to different dest network prefixes (GBP is 'path vector' protocol)</li>
<li>when AS3's gateway 3a advertises <code>path AS3, x</code> to AS2's gateway 2c, AS3 promises to AS2 it will forward datagrams to x
<ul>
<li>based on AS2 policy, AS2's router 2c accepts path and propagates (via iBGP) to all AS2 routers</li>
<li>then to AS1...</li>
</ul>
</li>
</ul>
</li>
<li>BGP advertised route:
<ul>
<li>prefix: destination advertised</li>
<li>two attributes:
<ul>
<li><code>AS-PATH</code>: list of ASes through which prefix advertisement has passed</li>
<li><code>NEXT_HOP</code>: indicates specific internal-AS router to next-hop As</li>
</ul>
</li>
</ul>
</li>
<li>policy-based routing:
<ul>
<li>gateway receiving route advertisement uses <em>import policy</em> to accept/decline path</li>
<li>AS policy also determines whether to advertise path to other neighbors</li>
<li>if there is multiple received message policy can choose best one</li>
<li>route selection criteria:
<ul>
<li>local preference value attribute</li>
<li>shortest <code>AS-PATH</code></li>
<li>closest <code>NEXT-HOP</code> router: hot potato</li>
<li>...</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>why 2 levels of routing?</p>
<ul>
<li>policy:
<ul>
<li>inter-AS: admin wants control over how is traffic routed</li>
<li>intra-AS: single admin, so policy is less of issue</li>
</ul>
</li>
<li>scale: hierarchical routing saves table size, reduces update traffic</li>
<li>performance:
<ul>
<li>inter-AS: policy more important</li>
<li>intra-AS: can focus on perf</li>
</ul>
</li>
</ul>
<p><em>hot potato routing</em>: when receiving multiple advertisements routing to same place, choose local gateway that has least intra-domain cost so that the datagram leaves current AS quickly</p>
<p><img src="assets/w12_4.PNG" alt="img"></p>
<ul>
<li>2d learns it can route X via either 2a or 2c, it chooses 2a.</li>
</ul>
<p>ISP only wants to route traffic to/from its customer networks (does not want
to carry transit traffic between other ISPs – a typical “real world” policy)</p>
<ul>
<li>when A advertises path Aw to B and to C, B can choose not to advertise BAw to C</li>
<li>so C will not know about CBAw path, and useCAw without B to get to w</li>
</ul>
<p><img src="assets/w12_5.PNG" alt="img"></p>
<h1 id="week-13-mar-28">Week 13. Mar 28</h1>
<h3 id="software-defined-networking-sdn-control-plane">software defined networking (SDN) control plane</h3>
<p>network layer is historically implemented via distributed, per-router contrl approach</p>
<ul>
<li><em>monolithic</em> router contains switching hardware, runs proprietary implementation of internet standard protocols in proprietary OS (eg cisco IOS)</li>
</ul>
<p>around 2005, there was renewed interest in rethinking control plane: take control plane off the proprietary switches and have a <em>logically centralized</em> control plane</p>
<ul>
<li>easier network management: avoid router misconfiguration, greater flexibility or traffic flows</li>
<li>table-based forwarding (openflow api) allows 'programming' routers
<ul>
<li>centralized 'programming' easier: compute tables centrally and distribute</li>
<li>distributed 'programming' more difficult: compute tables as result of distributed algorithm (protocol) implemented in each-and-every router</li>
</ul>
</li>
<li>openness</li>
</ul>
<p><strong>eg.</strong> in traditional routing, what if network operator wants u-to-z traffic to flow along one path instead of another? need to re-define link weights so traffic routing algorithm
computes routes accordingly (or even need a new one).</p>
<ul>
<li>what if we want to split traffic to two paths (load balancing)? not possible.</li>
<li>what if we want different routes depending on where traffic comes from? impossible with dest-based routing.</li>
</ul>
<p>SDN has 4 goals:</p>
<ol>
<li>generalized 'flow-based' forwarding</li>
<li>control and data plane separation</li>
<li>control plane functions external to data-plane switches</li>
<li>programmable control applications</li>
</ol>
<p>components:</p>
<ul>
<li>data-plane switches: fast, simple, commodity switches implementing generalized data-plane forwarding in hardware
<ul>
<li>flow table is computed and installed under controller supervision</li>
<li>has API for table-based switch control</li>
<li>protocol for communication with controller</li>
</ul>
</li>
<li>SDN controller (network OS):
<ul>
<li>maintain network state info</li>
<li>interacts with network switches 'below' via southbound API</li>
<li>interacts with network control apps 'above' via northbound API</li>
<li>implemented as distributed system for performance, scalability, fault-tolerance and robustness</li>
</ul>
</li>
<li>network-control apps: 'brains' of control
<ul>
<li>implement control functions using lower-level services, API provided by SDN contoller</li>
<li>unbundled: can be provided by 3rd party distinct from routing vendor of SDN controller</li>
<li>routing, access control, load balancing...</li>
</ul>
</li>
</ul>
<p>layers of SDN controller:</p>
<ul>
<li>interface layer to network apps: abtraction API</li>
<li>network-side state management: state of network links, switches and services (a distributed database)</li>
<li>communication: communicate between SDN controller and controlled switches</li>
</ul>
<p><img src="assets/w13_2.PNG" alt="img"></p>
<p>OpenFlow protocol:</p>
<ul>
<li>operates between controller and switches</li>
<li>TCP is used to exchange messages with optional encryption</li>
<li>3 classes of messages:
<ul>
<li>controller-to-switch</li>
<li>asynchronous (switch to controller)</li>
<li>symmetric (miscallaneous)</li>
</ul>
</li>
<li>different from OpenFlow API (used to specify generalized forwarding)</li>
</ul>
<p>key controller-to-switch messages</p>
<ul>
<li><em>features</em>: controller queries switch features, and switch replies</li>
<li><em>configure</em>: controller queries/set switch configuraitons</li>
<li><em>modify-state</em>: add, delete and modify flow entries in OpenFlow tables</li>
<li><em>packet-out</em>: controller can send this packet out of specific switch port</li>
</ul>
<p>key switch-to-controller messages</p>
<ul>
<li><em>packet-in</em>: transfer packets and its control to controller</li>
<li><em>flow-removed</em>: flow table entry deleted at switch</li>
<li><em>port status</em>: inform controller of a change on port</li>
</ul>
<p>network operators do not send these directly, but use  higher-level abstraction at controller.</p>
<h3 id="internet-control-message-protocol-icmp">internet control message protocol (ICMP)</h3>
<ul>
<li>used by hosts and routers tocommunicate network-level information
<ul>
<li>error reporting: unrechable host, network, port, protocol</li>
<li>echo request/reply: <code>ping</code></li>
</ul>
</li>
<li>it is network layer 'above' IP: ICMP messages are carried in IP datagrams</li>
<li>format: type, code, first 8 bytes of IP datagram causing error</li>
</ul>
<p>implementing <code>traceroute</code>:</p>
<ul>
<li>source sends sets of UDP segments to destination
<ul>
<li>1st set has TTL=1, 2nd set has TTL=2, etc.</li>
</ul>
</li>
<li>datagram in nth set arrives to nth router (after one hop, TTL is decremented until 0)
<ul>
<li>router will discard datagram and sends source ICMP message: type 11, code 0 (<code>ttl excpired</code>)</li>
<li>ICMP message possibly includes name of router and IP address</li>
</ul>
</li>
<li>when ICMP message is returned at source: it will record RTTs</li>
<li>UDP segments will eventually arrives at destination host
<ul>
<li>destination returns ICMP message: type 3, code 3 (<code>port unreachable</code>)</li>
<li>source stops</li>
</ul>
</li>
</ul>
<h2 id="link-layer">link layer</h2>
<ul>
<li>in link layer, we do not distinguish hosts and routers; they are <em>nodes</em></li>
<li><em>links</em>: communication channels that connect physically adjacent nodes along communication path</li>
<li><em>frames</em> encapsulate datagrams</li>
</ul>
<p>context:</p>
<ul>
<li>datagram transferred by different link protocols over different links
<ul>
<li>eg ethernet on first link, frame relay on second link, wifi on third link</li>
</ul>
</li>
<li>each link protocol provides different services: eg may or may not provide rdt over link</li>
</ul>
<p>link layer services:</p>
<ul>
<li><em>framing</em>: encapsulate datagrams into frames and add header and trailer
<ul>
<li>MAC address: used in frame to identify source and destination</li>
</ul>
</li>
<li>link access: channel access if shared medium</li>
<li>reliable delivery between adjacent nodes
<ul>
<li>seldom used on low bit-error link (fiber, some twisted pair)</li>
<li>wireless links: high error rates</li>
</ul>
</li>
<li>error detection: errors caused by signal attenuation and noise
<ul>
<li>receiver detects errors and signals errors for retransmission or drop frame</li>
</ul>
</li>
<li>error correction: without resorting to retransmission</li>
</ul>
<pre><code><code><div>encapsulate -&gt; add error checking bits, rdt, flow control, etc. -&gt; check errors, etc. -&gt; decapsulate
</div></code></code></pre>
<p>link layer is implemented in every host, in an 'adapter' (<em>network interface card (NIC)</em>) or on a chip attached into host system's buses.</p>
<ul>
<li>it is combination of hardware, software and firmware</li>
</ul>
<p>two types of links:</p>
<ul>
<li>point-to-point:
<ul>
<li>PPP for dialup access</li>
<li>point-to-point link between Ethernet switches and hosts</li>
</ul>
</li>
<li>broadcast (shared wire or medium):
<ul>
<li>old-fashioned Ethernet (shared wire)</li>
<li>upstream HFC</li>
<li>802.11 wireless LAN</li>
</ul>
</li>
</ul>
<h3 id="multiple-access-protocols">multiple access protocols</h3>
<ul>
<li>assume single shared broadcast channel</li>
<li>two or more simultaneous transmissions by nodes: can cause interference
<ul>
<li><em>collision</em>: when node receives two or more signals at same time</li>
</ul>
</li>
<li><em>multiple access protocol</em>: distributed algos that determine how nodes share chennel, ie when they can transmit</li>
<li>communication about channel sharing must use channel itself</li>
</ul>
<p>an ideal multiple access protocol:</p>
<ul>
<li>given broadcast channel of rate R bps</li>
<li>desired characteristics:
<ol>
<li>when one nodes wants to transmit, it can send at rate R</li>
<li>when M nodes want to transmit, they can send at rate R/M</li>
<li>fully decentralized:
<ul>
<li>no special node to coordinate transmissions</li>
<li>no synchronization of clocks and slots</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="mac-protocols">MAC protocols</h3>
<p>three broad classes</p>
<ol>
<li><em>channel partitioning</em>: divide channel to time slots, frequencies or codes and allocate pieces to node for exclusive use
<ul>
<li>TD, FD</li>
</ul>
</li>
<li><em>random access</em>: do not divide channel and allow collisions. try to fix them
<ul>
<li>CSMA/CD (used in ehernet), CSMA/CA (used in 802.11)</li>
</ul>
</li>
<li><em>'taking turns'</em>: nodes take turns, but nodes with more to send can take longer turns
<ul>
<li>bluetooth, FDDI, token ring</li>
</ul>
</li>
</ol>
<p>TDMA (time division multiple access):</p>
<ul>
<li>each station gets fixed length slot (length = packet transmission time) in each round</li>
<li>unused slos are idle</li>
</ul>
<p>FDMA (frequency division multiple access):</p>
<ul>
<li>each station assigned fixed frequency band</li>
<li>unused transmission time in frequency bands go idle</li>
</ul>
<p>random access protocols:</p>
<ul>
<li>transmit all full channel data rate R when node has packets to send</li>
<li><em>MAC protocol</em> specifies how to detect collisions and how to recover (eg via delayed retransmission)</li>
<li>examples: CSMA, CSMA/CD, CSMA/CA</li>
</ul>
<p><em>CSMA (carrier sense multiple access):</em></p>
<ul>
<li>listen before transmit</li>
<li>if channel sensed idle, then transmit entire frame</li>
<li>if channel sensed busy, deter transmission</li>
<li>propagation delays mean two nodes may not hear each other's transmission =&gt; collisions can still occur
<ul>
<li>distance and propagation delay affect the probability of collision</li>
</ul>
</li>
<li>if collision occurs, entire packet transmission time is wasted</li>
</ul>
<p><em>CSMA/CD (with collision detection)</em>:</p>
<ul>
<li>has carrier sensing and deferral as in CSMA
<ul>
<li>collision is detected in short time</li>
<li>colliding transmissions are aborted to reduce channel wastage</li>
</ul>
</li>
<li>detection:
<ul>
<li>easy in wired LAN: detect signal incoming signal energy while transmitting</li>
<li>difficult in wireless LANs: received signal strength overwhelmed by local transmission strength</li>
<li><em>jam signal</em> is sent by the detector to other NICs to alert them to collision (48bit 1010..)</li>
</ul>
</li>
<li>in ethernet CSMA/CD:
<ul>
<li>after aborting, NIC enters binary (exponential) backoff</li>
<li>after mth collision, NIC chooses K at random from {0,1,2, …, 2^m-1}. NIC waits K*512 <em>bit times</em> (time to transmist 1 bit), and then listen to channel to retransmit again</li>
<li>more collisons =&gt; longer backoff</li>
<li>this is to prevent colliding again after aborting</li>
</ul>
</li>
</ul>
<p><img src="assets/w13_1.PNG" alt="img"></p>
<p>a frame has to have at least 512 bits (in order for sender to know collision happened).</p>
<p><strong>eg.</strong> we have first collision, then two parties have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>b</mi></msub><mo stretchy="false">)</mo><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">(k_a,k_b)\in\{0,1\}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>. in which</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,0),(1,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> means they will collide again: probability 1/2</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,1),(1,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> means they will not collide: probability 1/2</li>
<li>the average wait time is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>T</mi></mrow><annotation encoding="application/x-tex">\frac{1}{2}T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></li>
</ul>
<p>if second collision happens, then two parties have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>a</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>b</mi></msub><mo stretchy="false">)</mo><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><msup><mo stretchy="false">}</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">(k_a,k_b)\in\{0,1,2,3\}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,0),(1,1),(2,2),(3,3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span> means they will collide again: probability 1/4</li>
<li>average wait time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>3</mn><mn>2</mn></mfrac><mi>T</mi></mrow><annotation encoding="application/x-tex">\frac{3}{2}T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></li>
</ul>
<p>probability of repetitive (m+1)th collision is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msup><mn>2</mn><mi>m</mi></msup><mrow><mi mathvariant="normal">∣</mi><mo stretchy="false">[</mo><msup><mn>2</mn><mi>m</mi></msup><mo>−</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mn>2</mn></msup><mi mathvariant="normal">∣</mi></mrow></mfrac><mo>=</mo><mfrac><msup><mn>2</mn><mi>m</mi></msup><msup><mn>2</mn><msup><mn>2</mn><mi>m</mi></msup></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{2^m}{|[2^m-1]^2|}=\frac{2^m}{2^{2^m}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.431em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.911em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mopen mtight">[</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight"><span class="mclose mtight">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2835em;vertical-align:-0.3725em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.911em;"><span style="top:-2.6275em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8035em;"><span style="top:-2.8035em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5175em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7246em;"><span style="top:-2.794em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3725em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>.</p>
<p>efficiency: transDelay / (transDelay + 5*propDelay)</p>
<p><em>CSMA/CA</em>: try to prevent colliding. before transmit, send a request to transmit message to access point which notifies others. minor collision can happen but is ok.</p>
<ul>
<li>why not CSMA/CD? it requires expensive attenna</li>
</ul>
<p><em>'taking turns'</em>:</p>
<ul>
<li>polling from central site: master node 'invites' slave nodes to transmit in turn</li>
<li>concerns:
<ul>
<li>polling overhead</li>
<li>latency</li>
<li>single point of failure (master)</li>
</ul>
</li>
<li>can have 'reelection'</li>
<li><em>token passing</em>: control tokens are passed from one node to next sequentially
<ul>
<li>concerns:
<ul>
<li>token overhead</li>
<li>latency</li>
<li>single point of failure (token)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="lan-addressing">LAN addressing</h3>
<ul>
<li>32-bit IP used for layer 3 (network layer) forwarding</li>
<li>MAC (or LAN or physical or ethernet) addressis used to get frame from one interface to another physically-connected interface</li>
<li>48 bit MAC (for most LANs) are burned in NIC ROM, also sometimes software settable</li>
<li>MAC addrress allocation is administered by IEEE. manufacturers buy portions of MAC address space</li>
<li>MAC flat address =&gt; portible: can move LAN card from one LAN to another
<ul>
<li>IP hierarchical address not portable: depends on IP subnset to which it belongs</li>
</ul>
</li>
</ul>
<p><em>ARP (address resolution protocol)</em>: translates IP to MAC address</p>
<ul>
<li>completely decentralized</li>
<li><em>ARP table</em>: each IP node on LAN has a table of mappings <code>(IP, MAC, TTL)</code></li>
<li>when A wants to send datagram to B and does not know B's MAC address
<ul>
<li>A broadcasts ARP query packet within subnet with B's IP address</li>
<li>B receives ARP packet and replies A with its MAC</li>
<li>A caches result until TTL expires</li>
<li>if A and B in different subnet, A's packet is sent to router, which replaces dst MAC address to which it knows, then send to next hop</li>
</ul>
</li>
<li>'plug and play': nodes create their ARP tables without intervention from net administrator</li>
</ul>
<p>ARP can also be used for annoucing.</p>
<h1 id="week-14-apr-4">Week 14. Apr 4</h1>
<h3 id="ethernet">ethernet</h3>
<p>physical topology:</p>
<ul>
<li>bus: all nodes in same collision domain (can collide with each other)</li>
<li>star: prevails today
<ul>
<li>active switch in center</li>
<li>each 'spoke' runs a (separate) ehernet protocol (nodes that do not collide with each other)</li>
</ul>
</li>
</ul>
<p>802.1 frame structure</p>
<ul>
<li>preamble: bytes with pattern 10101010 followed by one byte with pattern 10101011
<ul>
<li>used to synchronize receiver and sender lock rates</li>
</ul>
</li>
<li>addresses: 6 byte source and dest MAC addresses
<ul>
<li>if adapter receives frame with matching destination address, or with broadcast address (e.g. ARP packet), it passes data</li>
<li>otherwise drop
in frame to network layer protocol</li>
</ul>
</li>
<li>type: indicates higher layer protocol (mostly IP)</li>
<li>CRC (cyclic redundancy check): at receiver</li>
</ul>
<p>features:</p>
<ul>
<li>connectionless</li>
<li>unreliable: receiving NIC does not send acks or nacks to sending NIC
<ul>
<li>data in dropped frames are recovered only inf initial sender uses higher layer rdt</li>
</ul>
</li>
<li>ehternet's MAC protocol: unslotted CSMA/CD with binary backoff</li>
<li>there are many ethernet standards
<ul>
<li>common MAC protocol and frame format</li>
<li>different speeds</li>
<li>different physical layer media: fiber, cable</li>
</ul>
</li>
</ul>
<h3 id="switch">switch</h3>
<ul>
<li>link-layer device: take an active role
<ul>
<li>store-forward ethernet frames</li>
<li>examines incoming frame's MAC and selectively forward frame to one or more outgoing links when frame is to be forwarded on segment, uses CSMA/CD to access segment</li>
</ul>
</li>
<li>transparent: hosts do not know switches exist</li>
<li>plug-and-play, self-learning: switches do not need to be configured</li>
</ul>
<p>multiple simultaneous transmissions</p>
<ul>
<li>hosts have dedicated, direct connections to switch</li>
<li>ethernet protocol used on each incoming link, but no collisions; full duplex</li>
<li><em>switching</em>: multiple transmissions can happen at same time</li>
</ul>
<p><img src="assets/w14_1.PNG" alt="img"></p>
<p>how does switch know A' is reachable via intf4?</p>
<ul>
<li>it has a <em>switch table</em>: <code>(host MAC, interface to reach host, TTL)</code>
<ul>
<li>the interface IP is only used for finding reachability...</li>
</ul>
</li>
<li>switch can learn which hosts can be reached through which interfaces
<ul>
<li>when frame is received, switch learns location of sender: incoming LAN segment</li>
<li>then record sender/location pair in table</li>
</ul>
</li>
</ul>
<p>when frame is received at switch:</p>
<pre><code class="language-py"><div>record incoming link, MAC of sending host
index switch table using dest MAC
<span class="hljs-keyword">if</span> found:
    <span class="hljs-keyword">if</span> dest <span class="hljs-keyword">is</span> on segment <span class="hljs-keyword">from</span> which frame arrived:
        drop
    <span class="hljs-keyword">else</span>:
        forward frame to outgoing interface
<span class="hljs-keyword">else</span>:
    forward on <span class="hljs-built_in">all</span> interfaces <span class="hljs-keyword">except</span> arriving interface  <span class="hljs-comment"># flooding</span>
</div></code></pre>
<p>interconnecting switches handle forwarding similarly.</p>
<p>switches vs. routers:</p>
<ul>
<li>switch are on layer 2 (only uses l2 header info)</li>
<li>routers are on layer 3 (only uses l3 header info)</li>
<li>both are store-forward
<ul>
<li>routers: network-layer devices (sees network-layer headers)</li>
<li>switches: link-layer devices</li>
</ul>
</li>
<li>both have forwarding tables
<ul>
<li>routers: compute tables using routing algos and IP addresses</li>
<li>switches: learn forwarding table using flooding, learnings and MAC addresses</li>
</ul>
</li>
</ul>
<h3 id="virtual-lan-vlan">virtual LAN (VLAN)</h3>
<p>switches supporting VLAN capabilities can be configured to define multiple virtual LANS over single physical LAN infrastructure.</p>
<ul>
<li>switch ports can be grouped so that single physical switch operate as multiple virtual switches</li>
<li>whenever we broadcast (eg arp, DHCP, unknown MAC), we do not have to send message to the whole LAN</li>
</ul>
<p>features:</p>
<ul>
<li>traffic isolation: frames to/from subnet can only reach subnet</li>
<li>dynamic membership: ports can be dynamically assigned along VLANs</li>
<li>forwarding between VLANs: done via routing
<ul>
<li>in practice vendors sell combined switches plus routers</li>
</ul>
</li>
<li><em>trunking</em>: trunk port carries frames between VLANs defined over multiple physical switches
<ul>
<li>frames forwarded within VLAN between switches cannot be done in vanilla 802.1</li>
<li>802.1q protocol adds/removes additional header fields for frames forwarded between trunk ports</li>
</ul>
</li>
</ul>
<p><img src="assets/w14_2.PNG" alt="img"></p>
<h3 id="life-of-a-web-request">life of a web request</h3>
<p><img src="assets/w14_3.PNG" alt="img"></p>
<ol>
<li>connecting laptop needs to get its own IP of first-hop router and address of the DNS server: use DHCP
<ol>
<li>DHCP request encapsulated in UDP, encapsulated in IP, encapsulated in 802.3 ethernet</li>
<li>ethernet frame broadcast (with dest <code>ff:ff:ff:ff:ff:ff</code>) on LAN, received at router running DHCP server</li>
<li>ethernet demuxed to IP demuxed, UDP demuxed to DHCP</li>
<li>DHCP server formulates DHCP ACK containing client's IP address, IP address of first-hop router for client, name &amp; IP address of DNS server</li>
<li>encapsulation at DHCP server, frame forwarded (switch learning) through LAN, demultiplexing at client</li>
<li>DHCP client receives DHCP ACK reply</li>
</ol>
</li>
<li>before sending HTTP request, need IP of <code>www.google.ca</code>: use DNS
<ol>
<li>DNS query created, encapsulated in UDP, encapsulated in IP, encapsulated in Eth. to send frame to router, need MAC address of router interface: ARP</li>
<li>ARP query broadcast, received by router, which replies with ARP reply giving MAC address of router interface</li>
<li>client now knows MAC address of first hop router, so can now send frame containing DNS query</li>
<li>IP datagram containing DNS query forwarded via LAN switch from client to 1st hop router</li>
<li>IP datagram forwarded from campus network into comcast network, routed (tables created by RIP, OSPF, IS-IS and/or BGP routing protocols) to DNS server</li>
<li>demuxed to DNS server</li>
<li>DNS server replies to client with IP address of <code>www.google.ca</code></li>
</ol>
</li>
<li>to send HTTP request, client first opens TCP socket to web server
<ol>
<li>TCP SYN segment (step 1 in 3-way handshake) inter-domain routed to web server</li>
<li>web server responds with TCP SYNACK (step 2 in 3-way handshake)</li>
<li>TCP connection established</li>
<li>HTTP request sent into TCP socket</li>
<li>IP datagram containing HTTP request routed to <code>www.google.ca</code></li>
<li>web server responds with HTTP reply (containing web page)</li>
<li>IP datagram containing HTTP reply routed back to client</li>
</ol>
</li>
</ol>
<p>CSMA/CD,false,false,1/32/204.8,true,false,doesnotknow,CinterceptA,false,selflearn</p>

        <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </body>
    </html>